    - name: platform
{% if organization is defined %}
      {# Azure DevOps resources #}
      value: azure_devops
{% if qualifiers and qualifiers.project is defined %}
    - name: organization
      value: '{{ organization | default(match_resource.organization) | string }}'
    - name: project
      value: '{{ project.name | default(match_resource.project.name) | string }}'
{% elif qualifiers and qualifiers.resource and match_resource.resource_type.name != 'organization' %}
    - name: organization
      value: '{{ organization | default(match_resource.organization) | string }}'
{% endif %}
    - name: resource_name
      value: '{{ match_resource.name | string }}'
    - name: resource_type
      value: '{{ match_resource.resource_type.name | string }}'
{% for cr in child_resource_names | default([]) %}
    - name: child_resource
      value: '{{ cr | string | replace(":", "_") | replace("/", "_") }}'
{% endfor %}
{% else %}
      {# Azure ARM resources #}
      value: azure
    - name: subscription_id
      value: '{{ subscription_id | default(match_resource.subscription_id) | string }}'
    - name: subscription_name
      value: '{{ subscription_name | default(match_resource.subscription_name, match_resource.subscription_id) | string }}'
{% if resource_group is defined or (match_resource.resource_group is defined and match_resource.resource_group.name is defined) %}
    - name: resource_group
      value: '{{ resource_group.name | default(match_resource.resource_group.name) | string }}'
{% endif %}
    {% if qualifiers and qualifiers.resource is defined %}
    - name: resource_name
      value: '{{ qualifiers.resource | string }}'
    {% elif qualifiers and qualifiers.resource_group is defined %}
    - name: resource_name
      value: '{{ qualifiers.resource_group | string }}'
    {% elif match_resource.resource_group is defined and match_resource.resource_group.name is defined %}
    - name: resource_name
      value: '{{ match_resource.resource_group.name | string }}'
    {% elif match_resource.name is defined %}
    - name: resource_name
      value: '{{ match_resource.name | string }}'
    {% endif %}
{% for cr in child_resource_names | default([]) %}
    - name: child_resource
      value: '{{ cr | string | replace(":", "_") | replace("/", "_") }}'
{% endfor %}
{% set tags = match_resource.resource.tags %}
{% if tags %}
{% for k, v in tags.items() %}
    {% if v and v|string|trim != "" %}
    - name: "[azure]{{ k | string }}"
      value: '{{ v | string }}'
    {% endif %}
{% endfor %}
{% endif %}
{% endif %}

