{"version":3,"file":"pr-list.js","sourceRoot":"","sources":["../../../../../lib/workers/repository/onboarding/pr/pr-list.ts"],"names":[],"mappings":"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","sourcesContent":["import type { RenovateConfig } from '../../../../config/types';\nimport { logger } from '../../../../logger';\nimport { emojify } from '../../../../util/emoji';\nimport { regEx } from '../../../../util/regex';\nimport type { BranchConfig } from '../../../types';\n\nexport function getExpectedPrList(\n  config: RenovateConfig,\n  branches: BranchConfig[],\n): string {\n  logger.debug('getExpectedPrList()');\n  logger.trace({ config });\n  let prDesc = `\\n### What to Expect\\n\\n`;\n  if (!branches.length) {\n    return `${prDesc}It looks like your repository dependencies are already up-to-date and no Pull Requests will be necessary right away.\\n`;\n  }\n  prDesc += `With your current configuration, Renovate will create ${branches.length} Pull Request`;\n  prDesc += branches.length > 1 ? `s:\\n\\n` : `:\\n\\n`;\n\n  for (const branch of branches) {\n    const prTitleRe = regEx(/@([a-z]+\\/[a-z]+)/);\n    // TODO #22198\n    prDesc += `<details>\\n<summary>${branch.prTitle!.replace(\n      prTitleRe,\n      '@&#8203;$1',\n    )}</summary>\\n\\n`;\n    if (branch.schedule?.length) {\n      prDesc += `  - Schedule: ${JSON.stringify(branch.schedule)}\\n`;\n    }\n    prDesc += `  - Branch name: \\`${branch.branchName}\\`\\n`;\n    prDesc += branch.baseBranch\n      ? `  - Merge into: \\`${branch.baseBranch}\\`\\n`\n      : '';\n    const seen: string[] = [];\n    for (const upgrade of branch.upgrades) {\n      let text = '';\n      if (upgrade.updateType === 'lockFileMaintenance') {\n        text += '  - Regenerate lock files to use latest dependency versions';\n      } else {\n        if (upgrade.updateType === 'pin') {\n          text += '  - Pin ';\n        } else {\n          text += '  - Upgrade ';\n        }\n        if (upgrade.sourceUrl) {\n          // TODO: types (#22198)\n          text += `[${upgrade.depName!}](${upgrade.sourceUrl})`;\n        } else {\n          text += upgrade.depName!.replace(prTitleRe, '@&#8203;$1');\n        }\n        // TODO: types (#22198)\n        text += upgrade.isLockfileUpdate\n          ? ` to \\`${upgrade.newVersion!}\\``\n          : ` to \\`${upgrade.newDigest ?? upgrade.newValue!}\\``;\n        text += '\\n';\n      }\n      if (!seen.includes(text)) {\n        prDesc += text;\n        seen.push(text);\n      }\n    }\n    prDesc += '\\n\\n';\n    prDesc += '</details>\\n\\n';\n  }\n  // TODO: type (#22198)\n  const prHourlyLimit = config.prHourlyLimit!;\n  if (\n    prHourlyLimit > 0 &&\n    prHourlyLimit < 5 &&\n    prHourlyLimit < branches.length\n  ) {\n    prDesc += emojify(\n      `\\n\\n:children_crossing: Branch creation will be limited to maximum ${prHourlyLimit} per hour, so it doesn't swamp any CI resources or overwhelm the project. See docs for \\`prhourlylimit\\` for details.\\n\\n`,\n    );\n  }\n  return prDesc;\n}\n"]}