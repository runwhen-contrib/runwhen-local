{"version":3,"file":"index.js","sourceRoot":"","sources":["../../lib/config/index.ts"],"names":[],"mappings":";;;AAaA,4CAkBC;AAED,gDAcC;AAED,oCAsBC;;AAvED,sCAAmC;AACnC,gDAA0D;AAC1D,2DAAqC;AAOrC,mCAA2C;AAElC,iGAFA,wBAAgB,OAEA;AAEzB,SAAgB,gBAAgB,CAC9B,MAAsB,EACtB,OAAe;IAEf,IAAI,aAAa,GAAkB;QACjC,GAAG,MAAM;QACT,OAAO;KACR,CAAC;IACF,MAAM,UAAU,GAAG,IAAA,aAAG,EAAC,OAAO,EAAE,YAAY,CAAC,CAAC;IAC9C,IAAI,UAAU,EAAE,CAAC;QACf,aAAa,CAAC,UAAU,GAAG,UAAU,CAAC;IACxC,CAAC;IACD,yBAAyB;IACzB,aAAa,GAAG,IAAA,wBAAgB,EAAC,aAAa,EAAE,MAAM,CAAC,OAAO,CAAQ,CAAC,CAAC;IACxE,KAAK,MAAM,CAAC,IAAI,yBAAe,EAAE,CAAC;QAChC,OAAO,aAAa,CAAC,CAAC,CAAC,CAAC;IAC1B,CAAC;IACD,OAAO,aAAa,CAAC;AACvB,CAAC;AAED,SAAgB,kBAAkB,CAChC,MAAsB,EACtB,aAAsB;IAEtB,MAAM,YAAY,GAAmB,EAAE,GAAG,MAAM,EAAE,CAAC;IACnD,KAAK,MAAM,MAAM,IAAI,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;QAC1C,IAAI,aAAa,IAAI,MAAM,CAAC,oBAAoB,EAAE,CAAC;YACjD,SAAS;QACX,CAAC;QACD,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC;YACtB,OAAO,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACnC,CAAC;IACH,CAAC;IACD,OAAO,YAAY,CAAC;AACtB,CAAC;AAED,SAAgB,YAAY,CAC1B,WAAsB,EACtB,WAAgC;IAEhC,eAAM,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,iBAAiB,WAAW,IAAI,CAAC,CAAC;IACxE,MAAM,YAAY,GAAmB,EAAE,GAAG,WAAW,EAAE,CAAC;IACxD,MAAM,MAAM,GAA2B;QACrC,QAAQ;QACR,SAAS;QACT,YAAY;QACZ,SAAS;QACT,QAAQ;QACR,IAAI;KACL,CAAC;IACF,MAAM,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;IAChD,KAAK,MAAM,MAAM,IAAI,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;QAC1C,MAAM,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACjD,IAAI,WAAW,KAAK,CAAC,CAAC,IAAI,WAAW,GAAG,WAAW,EAAE,CAAC;YACpD,OAAO,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACnC,CAAC;IACH,CAAC;IACD,OAAO,YAAY,CAAC;AACtB,CAAC","sourcesContent":["import { logger } from '../logger';\nimport { allManagersList, get } from '../modules/manager';\nimport * as options from './options';\nimport type {\n  AllConfig,\n  ManagerConfig,\n  RenovateConfig,\n  RenovateConfigStage,\n} from './types';\nimport { mergeChildConfig } from './utils';\n\nexport { mergeChildConfig };\n\nexport function getManagerConfig(\n  config: RenovateConfig,\n  manager: string,\n): ManagerConfig {\n  let managerConfig: ManagerConfig = {\n    ...config,\n    manager,\n  };\n  const categories = get(manager, 'categories');\n  if (categories) {\n    managerConfig.categories = categories;\n  }\n  // TODO: fix types #22198\n  managerConfig = mergeChildConfig(managerConfig, config[manager] as any);\n  for (const i of allManagersList) {\n    delete managerConfig[i];\n  }\n  return managerConfig;\n}\n\nexport function removeGlobalConfig(\n  config: RenovateConfig,\n  keepInherited: boolean,\n): RenovateConfig {\n  const outputConfig: RenovateConfig = { ...config };\n  for (const option of options.getOptions()) {\n    if (keepInherited && option.inheritConfigSupport) {\n      continue;\n    }\n    if (option.globalOnly) {\n      delete outputConfig[option.name];\n    }\n  }\n  return outputConfig;\n}\n\nexport function filterConfig(\n  inputConfig: AllConfig,\n  targetStage: RenovateConfigStage,\n): AllConfig {\n  logger.trace({ config: inputConfig }, `filterConfig('${targetStage}')`);\n  const outputConfig: RenovateConfig = { ...inputConfig };\n  const stages: (string | undefined)[] = [\n    'global',\n    'inherit',\n    'repository',\n    'package',\n    'branch',\n    'pr',\n  ];\n  const targetIndex = stages.indexOf(targetStage);\n  for (const option of options.getOptions()) {\n    const optionIndex = stages.indexOf(option.stage);\n    if (optionIndex !== -1 && optionIndex < targetIndex) {\n      delete outputConfig[option.name];\n    }\n  }\n  return outputConfig;\n}\n"]}