{"version":3,"file":"locked-version.js","sourceRoot":"","sources":["../../../../lib/modules/manager/gleam/locked-version.ts"],"names":[],"mappings":";;AAKA,0DAqBC;AAED,sCAOC;AAnCD,4CAAyC;AACzC,+CAAkD;AAClD,yCAAiD;AACjD,qCAAwC;AAEjC,KAAK,UAAU,uBAAuB,CAC3C,YAAoB;IAEpB,MAAM,OAAO,GAAG,MAAM,IAAA,kBAAa,EAAC,YAAY,EAAE,MAAM,CAAC,CAAC;IAC1D,IAAI,CAAC,OAAO,EAAE,CAAC;QACb,eAAM,CAAC,KAAK,CAAC,mBAAmB,YAAY,YAAY,CAAC,CAAC;QAC1D,OAAO,IAAI,CAAC;IACd,CAAC;IAED,MAAM,iBAAiB,GAAG,IAAI,GAAG,EAAoB,CAAC;IACtD,MAAM,IAAI,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;IACpC,IAAI,CAAC,IAAI,EAAE,CAAC;QACV,eAAM,CAAC,KAAK,CAAC,iCAAiC,YAAY,EAAE,CAAC,CAAC;QAC9D,OAAO,IAAI,CAAC;IACd,CAAC;IACD,KAAK,MAAM,GAAG,IAAI,IAAA,mBAAW,EAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;QAC7C,MAAM,QAAQ,GAAG,IAAA,mBAAW,EAAC,iBAAiB,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9D,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC3B,iBAAiB,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;IAC5C,CAAC;IACD,OAAO,iBAAiB,CAAC;AAC3B,CAAC;AAED,SAAgB,aAAa,CAAC,eAAuB;IACnD,MAAM,GAAG,GAAG,qBAAY,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;IACpD,IAAI,GAAG,CAAC,OAAO,EAAE,CAAC;QAChB,OAAO,GAAG,CAAC,IAAI,CAAC;IAClB,CAAC;IACD,eAAM,CAAC,KAAK,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,KAAK,EAAE,EAAE,8BAA8B,CAAC,CAAC;IACjE,OAAO,IAAI,CAAC;AACd,CAAC","sourcesContent":["import { logger } from '../../../logger';\nimport { coerceArray } from '../../../util/array';\nimport { readLocalFile } from '../../../util/fs';\nimport { ManifestToml } from './schema';\n\nexport async function extractLockFileVersions(\n  lockFilePath: string,\n): Promise<Map<string, string[]> | null> {\n  const content = await readLocalFile(lockFilePath, 'utf8');\n  if (!content) {\n    logger.debug(`Gleam lock file ${lockFilePath} not found`);\n    return null;\n  }\n\n  const versionsByPackage = new Map<string, string[]>();\n  const lock = parseLockFile(content);\n  if (!lock) {\n    logger.debug(`Error parsing Gleam lock file ${lockFilePath}`);\n    return null;\n  }\n  for (const pkg of coerceArray(lock.packages)) {\n    const versions = coerceArray(versionsByPackage.get(pkg.name));\n    versions.push(pkg.version);\n    versionsByPackage.set(pkg.name, versions);\n  }\n  return versionsByPackage;\n}\n\nexport function parseLockFile(lockFileContent: string): ManifestToml | null {\n  const res = ManifestToml.safeParse(lockFileContent);\n  if (res.success) {\n    return res.data;\n  }\n  logger.debug({ err: res.error }, 'Error parsing manifest.toml.');\n  return null;\n}\n"]}