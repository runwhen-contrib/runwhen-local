{"version":3,"file":"collections-metadata.js","sourceRoot":"","sources":["../../../../lib/modules/manager/ansible-galaxy/collections-metadata.ts"],"names":[],"mappings":";;AAIA,wEA2BC;AA/BD,0EAAgF;AAEhF,iCAAsD;AAEtD,SAAgB,8BAA8B,CAC5C,KAAe;IAEf,MAAM,IAAI,GAAwB,EAAE,CAAC;IACrC,uEAAuE;IACvE,IAAI,oBAAoB,GAAG,KAAK,CAAC;IACjC,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;QACzB,IAAI,sBAAe,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;YAC/B,oBAAoB,GAAG,IAAI,CAAC;QAC9B,CAAC;aAAM,IAAI,oBAAoB,EAAE,CAAC;YAChC,wDAAwD;YACxD,MAAM,iBAAiB,GAAG,kBAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACjD,IAAI,iBAAiB,EAAE,MAAM,EAAE,CAAC;gBAC9B,MAAM,GAAG,GAAsB;oBAC7B,OAAO,EAAE,mBAAmB;oBAC5B,UAAU,EAAE,8CAA0B,CAAC,EAAE;oBACzC,OAAO,EAAE,iBAAiB,CAAC,MAAM,CAAC,WAAW;oBAC7C,YAAY,EAAE,iBAAiB,CAAC,MAAM,CAAC,OAAO;iBAC/C,CAAC;gBACF,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACjB,CAAC;iBAAM,CAAC;gBACN,6DAA6D;gBAC7D,MAAM;YACR,CAAC;QACH,CAAC;IACH,CAAC;IACD,OAAO,IAAI,CAAC;AACd,CAAC","sourcesContent":["import { GalaxyCollectionDatasource } from '../../datasource/galaxy-collection';\nimport type { PackageDependency } from '../types';\nimport { dependencyRegex, galaxyRegEx } from './util';\n\nexport function extractCollectionsMetaDataFile(\n  lines: string[],\n): PackageDependency[] {\n  const deps: PackageDependency[] = [];\n  // in a galaxy.yml the dependency map is inside a `dependencies:` block\n  let foundDependencyBlock = false;\n  for (const line of lines) {\n    if (dependencyRegex.exec(line)) {\n      foundDependencyBlock = true;\n    } else if (foundDependencyBlock) {\n      // expects a line like this `  ansible.windows: \"1.4.0\"`\n      const galaxyRegExResult = galaxyRegEx.exec(line);\n      if (galaxyRegExResult?.groups) {\n        const dep: PackageDependency = {\n          depType: 'galaxy-collection',\n          datasource: GalaxyCollectionDatasource.id,\n          depName: galaxyRegExResult.groups.packageName,\n          currentValue: galaxyRegExResult.groups.version,\n        };\n        deps.push(dep);\n      } else {\n        // if we can not match additional lines, the block has ended.\n        break;\n      }\n    }\n  }\n  return deps;\n}\n"]}