{"version":3,"file":"update-locked.js","sourceRoot":"","sources":["../../../../lib/modules/manager/poetry/update-locked.ts"],"names":[],"mappings":";;AAKA,wDAkBC;AAvBD,4CAAyC;AACzC,iDAA8C;AAE9C,qCAAoC;AAEpC,SAAgB,sBAAsB,CACpC,MAA0B;IAE1B,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,UAAU,EAAE,QAAQ,EAAE,eAAe,EAAE,GACtE,MAAM,CAAC;IACT,eAAM,CAAC,KAAK,CACV,kCAAkC,OAAO,IAAI,cAAc,OAAO,UAAU,KAAK,QAAQ,GAAG,CAC7F,CAAC;IAEF,MAAM,mBAAmB,GAAG,iBAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;IAC5E,OAAO,eAAM,CAAC,KAAK,CAAC,eAAe,EAAE,mBAAmB,CAAC;SACtD,SAAS,CACR,CAAC,aAAa,EAAsB,EAAE,CACpC,aAAa,KAAK,UAAU;QAC1B,CAAC,CAAC,EAAE,MAAM,EAAE,iBAAiB,EAAE;QAC/B,CAAC,CAAC,EAAE,MAAM,EAAE,aAAa,EAAE,CAChC;SACA,QAAQ,CAAC,EAAE,MAAM,EAAE,aAAa,EAAE,CAAC,CAAC;AACzC,CAAC","sourcesContent":["import { logger } from '../../../logger';\nimport { Result } from '../../../util/result';\nimport type { UpdateLockedConfig, UpdateLockedResult } from '../types';\nimport { Lockfile } from './schema';\n\nexport function updateLockedDependency(\n  config: UpdateLockedConfig,\n): UpdateLockedResult {\n  const { depName, currentVersion, newVersion, lockFile, lockFileContent } =\n    config;\n  logger.debug(\n    `poetry.updateLockedDependency: ${depName}@${currentVersion} -> ${newVersion} [${lockFile}]`,\n  );\n\n  const LockedVersionSchema = Lockfile.transform(({ lock }) => lock[depName]);\n  return Result.parse(lockFileContent, LockedVersionSchema)\n    .transform(\n      (lockedVersion): UpdateLockedResult =>\n        lockedVersion === newVersion\n          ? { status: 'already-updated' }\n          : { status: 'unsupported' },\n    )\n    .unwrapOr({ status: 'unsupported' });\n}\n"]}