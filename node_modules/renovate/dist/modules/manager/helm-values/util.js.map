{"version":3,"file":"util.js","sourceRoot":"","sources":["../../../../lib/modules/manager/helm-values/util.ts"],"names":[],"mappings":";;AAwBA,4EAWC;AAED,oEAKC;AA1CD,iDAA8C;AAC9C,+CAA4C;AAG5C,MAAM,WAAW,GAAG,IAAA,aAAK,EAAC,SAAS,CAAC,CAAC;AAErC;;;;;;;;;;;;;;;;;GAiBG;AACH,SAAgB,gCAAgC,CAC9C,SAAiB,EACjB,IAAa;IAEb,OAAO,CAAC,CAAC,CACP,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAC3B,IAAI;QACJ,OAAO,IAAI,KAAK,QAAQ;QACxB,IAAA,eAAM,EAAC,YAAY,EAAE,IAAI,CAAC;QAC1B,CAAC,IAAA,eAAM,EAAC,KAAK,EAAE,IAAI,CAAC,IAAI,IAAA,eAAM,EAAC,SAAS,EAAE,IAAI,CAAC,CAAC,CACjD,CAAC;AACJ,CAAC;AAED,SAAgB,4BAA4B,CAC1C,SAAiB,EACjB,IAAa;IAEb,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC;AAC7E,CAAC","sourcesContent":["import { hasKey } from '../../../util/object';\nimport { regEx } from '../../../util/regex';\nimport type { HelmDockerImageDependency } from './types';\n\nconst parentKeyRe = regEx(/image$/i);\n\n/**\n * Type guard to determine whether a given partial Helm values.yaml object potentially\n * defines a Helm Docker dependency.\n *\n * There is no exact standard of how Docker dependencies are defined in Helm\n * values.yaml files (as of February 26th 2021), this function defines a\n * heuristic based on the most commonly used format in the Helm charts:\n *\n * image:\n *   repository: 'something'\n *   tag: v1.0.0\n * image:\n *   repository: 'something'\n *   version: v1.0.0\n * renovateImage:\n *   repository: 'something'\n *   tag: v1.0.0\n */\nexport function matchesHelmValuesDockerHeuristic(\n  parentKey: string,\n  data: unknown,\n): data is HelmDockerImageDependency {\n  return !!(\n    parentKeyRe.test(parentKey) &&\n    data &&\n    typeof data === 'object' &&\n    hasKey('repository', data) &&\n    (hasKey('tag', data) || hasKey('version', data))\n  );\n}\n\nexport function matchesHelmValuesInlineImage(\n  parentKey: string,\n  data: unknown,\n): data is string {\n  return !!(parentKeyRe.test(parentKey) && data && typeof data === 'string');\n}\n"]}