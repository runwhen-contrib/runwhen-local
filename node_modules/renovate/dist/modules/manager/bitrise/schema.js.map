{"version":3,"file":"schema.js","sourceRoot":"","sources":["../../../../lib/modules/manager/bitrise/schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AACxB,yDAAqD;AACrD,6DAAkD;AAClD,mCAAoC;AAEvB,QAAA,WAAW,GAAG,mBAAI,CAAC,IAAI,CAClC,OAAC;KACE,MAAM,CAAC;IACN,uBAAuB,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAC9C,SAAS,EAAE,OAAC;SACT,MAAM,CACL,OAAC;SACE,MAAM,CAAC;QACN,KAAK,EAAE,OAAC;aACL,KAAK,CAAC,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;aAC7D,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;KACtC,CAAC;SACD,SAAS,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,CACnC;SACA,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;CAC7C,CAAC;KACD,SAAS,CAAC,CAAC,EAAE,uBAAuB,EAAE,eAAe,EAAE,SAAS,EAAE,EAAE,EAAE,CACrE,IAAA,sBAAS,EAAC,SAAS,EAAE,CAAC,QAAQ,EAAE,EAAE,CAAC,IAAA,iBAAS,EAAC,QAAQ,EAAE,eAAe,CAAC,CAAC,CACzE,CACJ,CAAC","sourcesContent":["import { z } from 'zod';\nimport { filterMap } from '../../../util/filter-map';\nimport { Yaml } from '../../../util/schema-utils';\nimport { parseStep } from './utils';\n\nexport const BitriseFile = Yaml.pipe(\n  z\n    .object({\n      default_step_lib_source: z.string().optional(),\n      workflows: z\n        .record(\n          z\n            .object({\n              steps: z\n                .array(z.record(z.unknown()).transform((x) => Object.keys(x)))\n                .transform((steps) => steps.flat()),\n            })\n            .transform(({ steps }) => steps),\n        )\n        .transform((x) => Object.values(x).flat()),\n    })\n    .transform(({ default_step_lib_source: defaultRegistry, workflows }) =>\n      filterMap(workflows, (workflow) => parseStep(workflow, defaultRegistry)),\n    ),\n);\n"]}