{"version":3,"file":"schema.js","sourceRoot":"","sources":["../../../../lib/modules/datasource/endoflife-date/schema.ts"],"names":[],"mappings":";;;AAAA,iCAAiC;AACjC,6BAAwB;AACxB,6DAAqD;AACrD,uDAAyD;AAGzD,MAAM,eAAe,GAAG,OAAC,CAAC,KAAK,CAAC;IAC9B,sBAAO,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE;QACtB,MAAM,GAAG,GAAG,gBAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC;QACnC,OAAO,CAAC,IAAI,GAAG,CAAC;IAClB,CAAC,CAAC;IACF,OAAC,CAAC,OAAO,EAAE;CACZ,CAAC,CAAC;AAEU,QAAA,qBAAqB,GAAG,OAAC;KACnC,MAAM,CAAC;IACN,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;IACjB,MAAM,EAAE,OAAC,CAAC,QAAQ,CAAC,OAAC,CAAC,MAAM,EAAE,CAAC;IAC9B,WAAW,EAAE,0BAAc;IAC3B,GAAG,EAAE,OAAC,CAAC,QAAQ,CAAC,eAAe,CAAC;IAChC,YAAY,EAAE,OAAC,CAAC,QAAQ,CAAC,eAAe,CAAC;CAC1C,CAAC;KACD,SAAS,CACR,CAAC,EACC,KAAK,EACL,MAAM,EACN,WAAW,EAAE,gBAAgB,EAC7B,GAAG,EACH,YAAY,GACb,EAAW,EAAE;IACZ,MAAM,OAAO,GAAG,MAAM,IAAI,KAAK,CAAC;IAChC,MAAM,YAAY,GAAG,GAAG,KAAK,IAAI,IAAI,YAAY,KAAK,IAAI,CAAC;IAC3D,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE,YAAY,EAAE,CAAC;AACrD,CAAC,CACF;KACA,KAAK,EAAE,CAAC","sourcesContent":["import { DateTime } from 'luxon';\nimport { z } from 'zod';\nimport { UtcDate } from '../../../util/schema-utils';\nimport { MaybeTimestamp } from '../../../util/timestamp';\nimport type { Release } from '../types';\n\nconst ExpireableField = z.union([\n  UtcDate.transform((x) => {\n    const now = DateTime.now().toUTC();\n    return x <= now;\n  }),\n  z.boolean(),\n]);\n\nexport const EndoflifeDateVersions = z\n  .object({\n    cycle: z.string(),\n    latest: z.optional(z.string()),\n    releaseDate: MaybeTimestamp,\n    eol: z.optional(ExpireableField),\n    discontinued: z.optional(ExpireableField),\n  })\n  .transform(\n    ({\n      cycle,\n      latest,\n      releaseDate: releaseTimestamp,\n      eol,\n      discontinued,\n    }): Release => {\n      const version = latest ?? cycle;\n      const isDeprecated = eol === true || discontinued === true;\n      return { version, releaseTimestamp, isDeprecated };\n    },\n  )\n  .array();\n"]}