{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../lib/modules/versioning/pep440/index.ts"],"names":[],"mappings":"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","sourcesContent":["import * as pep440 from '@renovatebot/pep440';\nimport type { RangeStrategy } from '../../../types/versioning';\nimport type { VersioningApi } from '../types';\nimport { getNewValue, isLessThanRange } from './range';\n\nexport const id = 'pep440';\nexport const displayName = 'PEP440';\nexport const urls = ['https://www.python.org/dev/peps/pep-0440/'];\nexport const supportsRanges = true;\nexport const supportedRangeStrategies: RangeStrategy[] = [\n  'bump',\n  'widen',\n  'pin',\n  'replace',\n];\n\nconst {\n  compare: sortVersions,\n  satisfies,\n  valid,\n  validRange,\n  explain,\n  gt: isGreaterThan,\n  major: getMajor,\n  minor: getMinor,\n  patch: getPatch,\n  eq,\n} = pep440;\n\nfunction isVersion(input: string | undefined | null): boolean {\n  // @renovatebot/pep440 isn't strict null save\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n  return !!valid(input!);\n}\n\nconst isStable = (input: string): boolean => {\n  const version = explain(input);\n  if (!version) {\n    return false;\n  }\n  return !version.is_prerelease;\n};\n\n// If this is left as an alias, inputs like \"17.04.0\" throw errors\nexport function isValid(input: string): boolean {\n  return validRange(input) || isVersion(input);\n}\n\nfunction getSatisfyingVersion(\n  versions: string[],\n  range: string,\n): string | null {\n  const found = pep440.filter(versions, range).sort(sortVersions);\n  return found.length === 0 ? null : found[found.length - 1];\n}\n\nfunction minSatisfyingVersion(\n  versions: string[],\n  range: string,\n): string | null {\n  const found = pep440.filter(versions, range).sort(sortVersions);\n  return found.length === 0 ? null : found[0];\n}\n\nexport function isSingleVersion(constraint: string): boolean {\n  return (\n    isVersion(constraint) ||\n    (constraint?.startsWith('==') && isVersion(constraint.substring(2).trim()))\n  );\n}\n\nexport { isVersion, matches };\n\nconst equals = (version1: string, version2: string): boolean =>\n  isVersion(version1) && isVersion(version2) && eq(version1, version2);\n\nfunction matches(version: string, range: string): boolean {\n  if (!isVersion(version)) {\n    return false;\n  }\n  if (isVersion(range)) {\n    return equals(version, range);\n  }\n  return isValid(range) && satisfies(version, range);\n}\n\nexport const api: VersioningApi = {\n  equals,\n  getMajor,\n  getMinor,\n  getPatch,\n  isCompatible: isVersion,\n  isGreaterThan,\n  isSingleVersion,\n  isStable,\n  isValid,\n  isVersion,\n  matches,\n  getSatisfyingVersion,\n  minSatisfyingVersion,\n  getNewValue,\n  sortVersions,\n  isLessThanRange,\n};\n\nexport default api;\n"]}