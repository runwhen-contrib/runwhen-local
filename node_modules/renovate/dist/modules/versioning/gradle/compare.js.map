{"version":3,"file":"compare.js","sourceRoot":"","sources":["../../../../lib/modules/versioning/gradle/compare.ts"],"names":[],"mappings":"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","sourcesContent":["import is from '@sindresorhus/is';\nimport { regEx } from '../../../util/regex';\n\nexport const TokenType = {\n  Number: 1,\n  String: 2,\n};\n\ninterface Token {\n  type: number;\n  val: string | number;\n}\n\nfunction iterateChars(\n  str: string,\n  cb: (p: string | null, n: string | null) => void,\n): void {\n  let prev = null;\n  let next = null;\n  for (let i = 0; i < str.length; i += 1) {\n    next = str.charAt(i);\n    cb(prev, next);\n    prev = next;\n  }\n  cb(prev, null);\n}\n\nfunction isSeparator(char: string): boolean {\n  return regEx(/^[-._+]$/i).test(char);\n}\n\nfunction isDigit(char: string): boolean {\n  return regEx(/^\\d$/).test(char);\n}\n\nfunction isLetter(char: string): boolean {\n  return !isSeparator(char) && !isDigit(char);\n}\n\nfunction isTransition(prevChar: string, nextChar: string): boolean {\n  return (\n    (isDigit(prevChar) && isLetter(nextChar)) ||\n    (isLetter(prevChar) && isDigit(nextChar))\n  );\n}\n\nexport function tokenize(versionStr: string): Token[] | null {\n  let result: Token[] | null = [];\n  let currentVal = '';\n\n  function yieldToken(): void {\n    if (result) {\n      const val = currentVal;\n      if (regEx(/^\\d+$/).test(val)) {\n        result.push({\n          type: TokenType.Number,\n          val: parseInt(val, 10),\n        });\n      } else {\n        result.push({\n          type: TokenType.String,\n          val,\n        });\n      }\n    }\n  }\n\n  iterateChars(versionStr, (prevChar, nextChar) => {\n    if (nextChar === null) {\n      yieldToken();\n    } else if (isSeparator(nextChar)) {\n      if (prevChar && !isSeparator(prevChar)) {\n        yieldToken();\n        currentVal = '';\n      } else {\n        result = null;\n      }\n    } else if (prevChar !== null && isTransition(prevChar, nextChar)) {\n      yieldToken();\n      currentVal = nextChar;\n    } else {\n      currentVal = currentVal.concat(nextChar);\n    }\n  });\n\n  return result;\n}\n\nexport const QualifierRank = {\n  Dev: -1,\n  Default: 0,\n  RC: 1,\n  Snapshot: 2,\n  Final: 3,\n  GA: 4,\n  Release: 5,\n  SP: 6,\n} as const;\n\nexport function qualifierRank(input: string): number {\n  const val = input.toLowerCase();\n  if (val === 'dev') {\n    return QualifierRank.Dev;\n  }\n  if (val === 'rc' || val === 'cr') {\n    return QualifierRank.RC;\n  }\n  if (val === 'snapshot') {\n    return QualifierRank.Snapshot;\n  }\n  if (val === 'ga') {\n    return QualifierRank.GA;\n  }\n  if (val === 'final') {\n    return QualifierRank.Final;\n  }\n  if (val === 'release' || val === 'latest' || val === 'sr') {\n    return QualifierRank.Release;\n  }\n  if (val === 'sp') {\n    return QualifierRank.SP;\n  }\n  return QualifierRank.Default;\n}\n\nfunction stringTokenCmp(left: string, right: string): number {\n  const leftRank = qualifierRank(left);\n  const rightRank = qualifierRank(right);\n  if (leftRank === 0 && rightRank === 0) {\n    if (left < right) {\n      return -1;\n    }\n\n    if (left > right) {\n      return 1;\n    }\n  } else {\n    if (leftRank < rightRank) {\n      return -1;\n    }\n    if (leftRank > rightRank) {\n      return 1;\n    }\n  }\n  return 0;\n}\n\nfunction tokenCmp(left: Token | null, right: Token | null): number {\n  if (left === null) {\n    if (right?.type === TokenType.String) {\n      return 1;\n    }\n    return -1;\n  }\n\n  if (right === null) {\n    if (left.type === TokenType.String) {\n      return -1;\n    }\n    return 1;\n  }\n\n  if (left.type === TokenType.Number && right.type === TokenType.Number) {\n    if (left.val < right.val) {\n      return -1;\n    }\n    if (left.val > right.val) {\n      return 1;\n    }\n  } else if (typeof left.val === 'string' && typeof right.val === 'string') {\n    return stringTokenCmp(left.val, right.val);\n  } else if (right.type === TokenType.Number) {\n    return -1;\n  } else if (left.type === TokenType.Number) {\n    return 1;\n  }\n\n  return 0;\n}\n\nexport function compare(left: string, right: string): number {\n  const leftTokens = tokenize(left) ?? [];\n  const rightTokens = tokenize(right) ?? [];\n  const length = Math.max(leftTokens.length, rightTokens.length);\n  for (let idx = 0; idx < length; idx += 1) {\n    const leftToken = leftTokens[idx] || null;\n    const rightToken = rightTokens[idx] || null;\n    const cmpResult = tokenCmp(leftToken, rightToken);\n    if (cmpResult !== 0) {\n      return cmpResult;\n    }\n  }\n  return 0;\n}\n\nexport function parse(input: string): Token[] | null {\n  if (!input) {\n    return null;\n  }\n\n  if (!regEx(/^[-._+a-zA-Z0-9]+$/i).test(input)) {\n    return null;\n  }\n\n  if (regEx(/^latest\\.?/i).test(input)) {\n    return null;\n  }\n\n  const tokens = tokenize(input);\n  // istanbul ignore if: should not happen\n  if (!tokens?.length) {\n    return null;\n  }\n  return tokens;\n}\n\nexport function isVersion(input: string): boolean {\n  return !!parse(input);\n}\n\ninterface PrefixRange {\n  tokens: Token[];\n}\n\nexport type RangeBound = 'inclusive' | 'exclusive';\n\ninterface MavenBasedRange {\n  leftBound: RangeBound;\n  leftBoundStr: string;\n  leftVal: string | null;\n  separator: string;\n  rightBound: RangeBound;\n  rightBoundStr: string;\n  rightVal: string | null;\n}\n\nexport function parsePrefixRange(input: string): PrefixRange | null {\n  if (!input) {\n    return null;\n  }\n\n  if (input.trim() === '+') {\n    return { tokens: [] };\n  }\n\n  const postfixRegex = regEx(/[^-._+][-._]\\+$/);\n  if (postfixRegex.test(input)) {\n    const prefixValue = input.replace(regEx(/[-._]\\+$/), '');\n    const tokens = tokenize(prefixValue);\n    if (tokens) {\n      return { tokens };\n    }\n  }\n\n  return null;\n}\n\nconst mavenBasedRangeRegex = regEx(\n  /^(?<leftBoundStr>[[\\](]\\s*)(?<leftVal>[-._+a-zA-Z0-9]*?)(?<separator>\\s*,\\s*)(?<rightVal>[-._+a-zA-Z0-9]*?)(?<rightBoundStr>\\s*[[\\])])$/,\n);\n\nexport function parseMavenBasedRange(input: string): MavenBasedRange | null {\n  if (!input) {\n    return null;\n  }\n\n  const matchGroups = mavenBasedRangeRegex.exec(input)?.groups;\n  if (matchGroups) {\n    const { leftBoundStr, separator, rightBoundStr } = matchGroups;\n    let leftVal: string | null = matchGroups.leftVal;\n    let rightVal: string | null = matchGroups.rightVal;\n    if (!leftVal) {\n      leftVal = null;\n    }\n    if (!rightVal) {\n      rightVal = null;\n    }\n    const isVersionLeft = is.string(leftVal) && isVersion(leftVal);\n    const isVersionRight = is.string(rightVal) && isVersion(rightVal);\n    if (\n      (leftVal === null || isVersionLeft) &&\n      (rightVal === null || isVersionRight)\n    ) {\n      if (\n        isVersionLeft &&\n        isVersionRight &&\n        leftVal &&\n        rightVal &&\n        compare(leftVal, rightVal) === 1\n      ) {\n        return null;\n      }\n      const leftBound = leftBoundStr.trim() === '[' ? 'inclusive' : 'exclusive';\n      const rightBound =\n        rightBoundStr.trim() === ']' ? 'inclusive' : 'exclusive';\n      return {\n        leftBound,\n        leftBoundStr,\n        leftVal,\n        separator,\n        rightBound,\n        rightBoundStr,\n        rightVal,\n      };\n    }\n  }\n\n  return null;\n}\n\ninterface SingleVersionRange {\n  val: string;\n}\n\nconst singleVersionRangeRegex = regEx(/^\\[\\s*(?<val>[-._+a-zA-Z0-9]*?)\\s*\\]$/);\n\nexport function parseSingleVersionRange(\n  input: string,\n): SingleVersionRange | null {\n  const matchGroups = singleVersionRangeRegex.exec(input)?.groups;\n  if (!matchGroups) {\n    return null;\n  }\n\n  const { val } = matchGroups;\n  if (!isVersion(val)) {\n    return null;\n  }\n\n  return { val };\n}\n\nexport function isValid(str: string): boolean {\n  if (!str) {\n    return false;\n  }\n\n  return (\n    isVersion(str) ||\n    !!parsePrefixRange(str) ||\n    !!parseMavenBasedRange(str) ||\n    !!parseSingleVersionRange(str)\n  );\n}\n"]}