{"version":3,"file":"utils.js","sourceRoot":"","sources":["../../../lib/util/vulnerability/utils.ts"],"names":[],"mappings":";;AASA,0EAkBC;AA3BD,MAAM,aAAa,GAA2B;IAC5C,GAAG,EAAE,CAAC;IACN,MAAM,EAAE,CAAC;IACT,QAAQ,EAAE,CAAC;IACX,IAAI,EAAE,CAAC;IACP,QAAQ,EAAE,CAAC;IACX,OAAO,EAAE,CAAC;CACX,CAAC;AAEF,SAAgB,+BAA+B,CAG7C,MAAS,EAAE,KAAa;IACxB,MAAM,iBAAiB,GAAG,MAAM,CAAC,qBAAqB,EAAE,WAAW,EAAE,CAAC;IACtE,MAAM,gBAAgB,GAAG,KAAK,EAAE,qBAAqB,EAAE,WAAW,EAAE,CAAC;IAErE,IAAI,gBAAgB,KAAK,SAAS,EAAE,CAAC;QACnC,OAAO,iBAAiB,CAAC;IAC3B,CAAC;IAED,IAAI,iBAAiB,KAAK,SAAS,EAAE,CAAC;QACpC,OAAO,gBAAgB,CAAC;IAC1B,CAAC;IAED,OAAO,aAAa,CAAC,iBAAiB,CAAC,IAAI,aAAa,CAAC,gBAAgB,CAAC;QACxE,CAAC,CAAC,iBAAiB;QACnB,CAAC,CAAC,gBAAgB,CAAC;AACvB,CAAC","sourcesContent":["const severityOrder: Record<string, number> = {\n  LOW: 1,\n  MEDIUM: 2,\n  MODERATE: 2,\n  HIGH: 3,\n  CRITICAL: 4,\n  UNKNOWN: 5,\n};\n\nexport function getHighestVulnerabilitySeverity<\n  T extends Record<string, any>,\n  TChild extends Record<string, any> | undefined,\n>(parent: T, child: TChild): string {\n  const parentVulSeverity = parent.vulnerabilitySeverity?.toUpperCase();\n  const childVulSeverity = child?.vulnerabilitySeverity?.toUpperCase();\n\n  if (childVulSeverity === undefined) {\n    return parentVulSeverity;\n  }\n\n  if (parentVulSeverity === undefined) {\n    return childVulSeverity;\n  }\n\n  return severityOrder[parentVulSeverity] >= severityOrder[childVulSeverity]\n    ? parentVulSeverity\n    : childVulSeverity;\n}\n"]}