{"version":3,"file":"tags.js","sourceRoot":"","sources":["../../../lib/util/github/tags.ts"],"names":[],"mappings":";;AAIA,0CAkCC;AAtCD,yCAAsC;AAEtC,uCAAsC;AAE/B,KAAK,UAAU,eAAe,CACnC,WAA+B,EAC/B,WAAmB,EACnB,GAAW,EACX,IAAgB;IAEhB,eAAM,CAAC,KAAK,CAAC,+BAA+B,WAAW,KAAK,GAAG,GAAG,CAAC,CAAC;IACpE,IAAI,CAAC;QACH,MAAM,IAAI,GAAG,MAAM,IAAA,mBAAS,EAAC,EAAE,WAAW,EAAE,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QACjE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACjB,eAAM,CAAC,KAAK,CACV,oDAAoD,WAAW,EAAE,CAClE,CAAC;QACJ,CAAC;QACD,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,OAAO,KAAK,GAAG,CAAC,CAAC;QAC5D,IAAI,OAAO,EAAE,CAAC;YACZ,IAAI,OAAO,CAAC,IAAI,EAAE,CAAC;gBACjB,OAAO,OAAO,CAAC,IAAI,CAAC;YACtB,CAAC;YACD,eAAM,CAAC,KAAK,CACV,oCAAoC,GAAG,oBAAoB,WAAW,EAAE,CACzE,CAAC;QACJ,CAAC;aAAM,CAAC;YACN,eAAM,CAAC,KAAK,CACV,oCAAoC,GAAG,kBAAkB,WAAW,EAAE,CACvE,CAAC;QACJ,CAAC;IACH,CAAC;IAAC,OAAO,GAAG,EAAE,CAAC;QACb,eAAM,CAAC,KAAK,CACV,EAAE,UAAU,EAAE,WAAW,EAAE,GAAG,EAAE,EAChC,2CAA2C,CAC5C,CAAC;IACJ,CAAC;IACD,OAAO,IAAI,CAAC;AACd,CAAC","sourcesContent":["import { logger } from '../../logger';\nimport type { GithubHttp } from '../http/github';\nimport { queryTags } from './graphql';\n\nexport async function findCommitOfTag(\n  registryUrl: string | undefined,\n  packageName: string,\n  tag: string,\n  http: GithubHttp,\n): Promise<string | null> {\n  logger.trace(`github/tags.findCommitOfTag(${packageName}, ${tag})`);\n  try {\n    const tags = await queryTags({ packageName, registryUrl }, http);\n    if (!tags.length) {\n      logger.debug(\n        `github/tags.findCommitOfTag(): No tags found for ${packageName}`,\n      );\n    }\n    const tagItem = tags.find(({ version }) => version === tag);\n    if (tagItem) {\n      if (tagItem.hash) {\n        return tagItem.hash;\n      }\n      logger.debug(\n        `github/tags.findCommitOfTag: Tag ${tag} has no hash for ${packageName}`,\n      );\n    } else {\n      logger.debug(\n        `github/tags.findCommitOfTag: Tag ${tag} not found for ${packageName}`,\n      );\n    }\n  } catch (err) {\n    logger.debug(\n      { githubRepo: packageName, err },\n      'Error getting tag commit from GitHub repo',\n    );\n  }\n  return null;\n}\n"]}