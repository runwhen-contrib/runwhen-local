{"version":3,"file":"merge-confidence.js","sourceRoot":"","sources":["../../../lib/util/package-rules/merge-confidence.ts"],"names":[],"mappings":";;;;AAAA,kEAAkC;AAElC,mEAAyE;AACzE,0DAAkD;AAClD,iCAAiC;AAEjC,MAAa,sBAAuB,SAAQ,cAAO;IACxC,OAAO,CACd,EAAE,oBAAoB,EAA0B,EAChD,EAAE,eAAe,EAAe;QAEhC,IAAI,YAAE,CAAC,eAAe,CAAC,eAAe,CAAC,EAAE,CAAC;YACxC,OAAO,IAAI,CAAC;QACd,CAAC;QAED;;WAEG;QACH,IAAI,YAAE,CAAC,SAAS,CAAC,IAAA,8BAAW,GAAE,CAAC,EAAE,CAAC;YAChC,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,wCAAuB,CAAC,CAAC;YACjD,KAAK,CAAC,gBAAgB,GAAG,+BAA+B,CAAC;YACzD,KAAK,CAAC,eAAe,GAAG,qBAAqB,CAAC;YAC9C,KAAK,CAAC,iBAAiB;gBACrB,mNAAmN,CAAC;YACtN,MAAM,KAAK,CAAC;QACd,CAAC;QAED,OAAO,CACL,YAAE,CAAC,KAAK,CAAC,eAAe,CAAC;YACzB,YAAE,CAAC,cAAc,CAAC,oBAAoB,CAAC;YACvC,eAAe,CAAC,QAAQ,CAAC,oBAAoB,CAAC,CAC/C,CAAC;IACJ,CAAC;CACF;AA3BD,wDA2BC","sourcesContent":["import is from '@sindresorhus/is';\nimport type { PackageRule, PackageRuleInputConfig } from '../../config/types';\nimport { MISSING_API_CREDENTIALS } from '../../constants/error-messages';\nimport { getApiToken } from '../merge-confidence';\nimport { Matcher } from './base';\n\nexport class MergeConfidenceMatcher extends Matcher {\n  override matches(\n    { mergeConfidenceLevel }: PackageRuleInputConfig,\n    { matchConfidence }: PackageRule,\n  ): boolean | null {\n    if (is.nullOrUndefined(matchConfidence)) {\n      return null;\n    }\n\n    /*\n     * Throw an error for unauthenticated use of the matchConfidence matcher.\n     */\n    if (is.undefined(getApiToken())) {\n      const error = new Error(MISSING_API_CREDENTIALS);\n      error.validationSource = 'MatchConfidence Authenticator';\n      error.validationError = 'Missing credentials';\n      error.validationMessage =\n        'The `matchConfidence` matcher in `packageRules` requires authentication. Please refer to the [documentation](https://docs.renovatebot.com/configuration-options/#matchconfidence) and add the required host rule.';\n      throw error;\n    }\n\n    return (\n      is.array(matchConfidence) &&\n      is.nonEmptyString(mergeConfidenceLevel) &&\n      matchConfidence.includes(mergeConfidenceLevel)\n    );\n  }\n}\n"]}