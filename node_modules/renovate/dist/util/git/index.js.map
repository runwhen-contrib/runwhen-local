{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../lib/util/git/index.ts"],"names":[],"mappings":"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","sourcesContent":["import URL from 'node:url';\nimport { setTimeout } from 'timers/promises';\nimport is from '@sindresorhus/is';\nimport fs from 'fs-extra';\nimport semver from 'semver';\nimport type { Options, SimpleGit, TaskOptions } from 'simple-git';\nimport { ResetMode, simpleGit } from 'simple-git';\nimport upath from 'upath';\nimport { configFileNames } from '../../config/app-strings';\nimport { GlobalConfig } from '../../config/global';\nimport type { RenovateConfig } from '../../config/types';\nimport {\n  CONFIG_VALIDATION,\n  INVALID_PATH,\n  REPOSITORY_CHANGED,\n  REPOSITORY_DISABLED,\n  REPOSITORY_EMPTY,\n  SYSTEM_INSUFFICIENT_DISK_SPACE,\n  TEMPORARY_ERROR,\n} from '../../constants/error-messages';\nimport { logger } from '../../logger';\nimport { ExternalHostError } from '../../types/errors/external-host-error';\nimport type { GitProtocol } from '../../types/git';\nimport { incLimitedValue } from '../../workers/global/limits';\nimport { getCache } from '../cache/repository';\nimport { newlineRegex, regEx } from '../regex';\nimport { matchRegexOrGlobList } from '../string-match';\nimport { parseGitAuthor } from './author';\nimport {\n  getCachedBehindBaseResult,\n  setCachedBehindBaseResult,\n} from './behind-base-branch-cache';\nimport { getNoVerify, simpleGitConfig } from './config';\nimport {\n  getCachedConflictResult,\n  setCachedConflictResult,\n} from './conflicts-cache';\nimport {\n  bulkChangesDisallowed,\n  checkForPlatformFailure,\n  handleCommitError,\n} from './error';\nimport {\n  getCachedModifiedResult,\n  setCachedModifiedResult,\n} from './modified-cache';\nimport { configSigningKey, writePrivateKey } from './private-key';\nimport type {\n  CommitFilesConfig,\n  CommitResult,\n  LocalConfig,\n  LongCommitSha,\n  PushFilesConfig,\n  StatusResult,\n  StorageConfig,\n  TreeItem,\n} from './types';\n\nexport { setNoVerify } from './config';\nexport { setPrivateKey } from './private-key';\n\n// Retry parameters\nconst retryCount = 5;\nconst delaySeconds = 3;\nconst delayFactor = 2;\n\n// A generic wrapper for simpleGit.* calls to make them more fault-tolerant\nexport async function gitRetry<T>(gitFunc: () => Promise<T>): Promise<T> {\n  let round = 0;\n  let lastError: Error | undefined;\n\n  while (round <= retryCount) {\n    if (round > 0) {\n      logger.debug(`gitRetry round ${round}`);\n    }\n    try {\n      const res = await gitFunc();\n      if (round > 1) {\n        logger.debug('Successful retry of git function');\n      }\n      return res;\n    } catch (err) {\n      lastError = err;\n      logger.debug({ err }, `Git function thrown`);\n      // Try to transform the Error to ExternalHostError\n      const errChecked = checkForPlatformFailure(err);\n      if (errChecked instanceof ExternalHostError) {\n        logger.debug(\n          { err: errChecked },\n          `ExternalHostError thrown in round ${\n            round + 1\n          } of ${retryCount} - retrying in the next round`,\n        );\n      } else {\n        throw err;\n      }\n    }\n\n    const nextDelay = delayFactor ^ ((round - 1) * delaySeconds);\n    logger.trace({ nextDelay }, `Delay next round`);\n    await setTimeout(1000 * nextDelay);\n\n    round++;\n  }\n\n  // Can't be `undefined` here.\n  // eslint-disable-next-line @typescript-eslint/only-throw-error\n  throw lastError;\n}\n\nasync function isDirectory(dir: string): Promise<boolean> {\n  try {\n    return (await fs.stat(dir)).isDirectory();\n  } catch {\n    return false;\n  }\n}\n\nasync function getDefaultBranch(git: SimpleGit): Promise<string> {\n  // see https://stackoverflow.com/a/62352647/3005034\n  try {\n    let res = await git.raw(['rev-parse', '--abbrev-ref', 'origin/HEAD']);\n    /* v8 ignore start -- TODO: add test */\n    if (!res) {\n      logger.debug('Could not determine default branch using git rev-parse');\n      const headPrefix = 'HEAD branch: ';\n      res = (await git.raw(['remote', 'show', 'origin']))\n        .split('\\n')\n        .map((line) => line.trim())\n        .find((line) => line.startsWith(headPrefix))!\n        .replace(headPrefix, '');\n    }\n    /* v8 ignore stop */\n    return res.replace('origin/', '').trim();\n    /* v8 ignore start -- TODO: add test */\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    if (\n      err.message.startsWith(\n        'fatal: ref refs/remotes/origin/HEAD is not a symbolic ref',\n      )\n    ) {\n      throw new Error(REPOSITORY_EMPTY);\n    }\n    if (err.message.includes(\"fatal: ambiguous argument 'origin/HEAD'\")) {\n      logger.warn({ err }, 'Error getting default branch');\n      throw new Error(TEMPORARY_ERROR);\n    }\n    throw err;\n  }\n  /* v8 ignore stop */\n}\n\nlet config: LocalConfig = {} as any;\n\n// TODO: can be undefined\nlet git: SimpleGit;\nlet gitInitialized: boolean;\nlet submodulesInitizialized: boolean;\n\nlet privateKeySet = false;\n\nexport const GIT_MINIMUM_VERSION = '2.33.0'; // git show-current\n\nexport async function validateGitVersion(): Promise<boolean> {\n  let version: string | undefined;\n  const globalGit = simpleGit();\n  try {\n    const { major, minor, patch, installed } = await globalGit.version();\n    /* v8 ignore next 4 -- TODO: add test */\n    if (!installed) {\n      logger.error('Git not installed');\n      return false;\n    }\n    version = `${major}.${minor}.${patch}`;\n    /* v8 ignore next 4 */\n  } catch (err) {\n    logger.error({ err }, 'Error fetching git version');\n    return false;\n  }\n  /* v8 ignore next 7 -- TODO: add test */\n  if (!(version && semver.gte(version, GIT_MINIMUM_VERSION))) {\n    logger.error(\n      { detectedVersion: version, minimumVersion: GIT_MINIMUM_VERSION },\n      'Git version needs upgrading',\n    );\n    return false;\n  }\n  logger.debug(`Found valid git version: ${version}`);\n  return true;\n}\n\nasync function fetchBranchCommits(): Promise<void> {\n  config.branchCommits = {};\n  const opts = ['ls-remote', '--heads', config.url];\n  if (config.extraCloneOpts) {\n    Object.entries(config.extraCloneOpts).forEach((e) =>\n      // TODO: types (#22198)\n      opts.unshift(e[0], `${e[1]!}`),\n    );\n  }\n  try {\n    const lsRemoteRes = await gitRetry(() => git.raw(opts));\n    logger.trace({ lsRemoteRes }, 'git ls-remote result');\n    lsRemoteRes\n      .split(newlineRegex)\n      .filter(Boolean)\n      .map((line) => line.trim().split(regEx(/\\s+/)))\n      .forEach(([sha, ref]) => {\n        config.branchCommits[ref.replace('refs/heads/', '')] =\n          sha as LongCommitSha;\n      });\n    logger.trace({ branchCommits: config.branchCommits }, 'branch commits');\n    /* v8 ignore next 11 -- TODO: add test */\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    logger.debug({ err }, 'git error');\n    if (err.message?.includes('Please ask the owner to check their account')) {\n      throw new Error(REPOSITORY_DISABLED);\n    }\n    throw err;\n  }\n}\n\nexport async function fetchRevSpec(revSpec: string): Promise<void> {\n  await gitRetry(() => git.fetch(['origin', revSpec]));\n}\n\nexport async function initRepo(args: StorageConfig): Promise<void> {\n  config = { ...args } as any;\n  config.ignoredAuthors = [];\n  config.additionalBranches = [];\n  config.branchIsModified = {};\n  git = simpleGit(GlobalConfig.get('localDir'), simpleGitConfig()).env({\n    ...process.env,\n    LANG: 'C.UTF-8',\n    LC_ALL: 'C.UTF-8',\n  });\n  gitInitialized = false;\n  submodulesInitizialized = false;\n  await fetchBranchCommits();\n}\n\nasync function resetToBranch(branchName: string): Promise<void> {\n  logger.debug(`resetToBranch(${branchName})`);\n  await git.raw(['reset', '--hard']);\n  await gitRetry(() => git.checkout(branchName));\n  await git.raw(['reset', '--hard', 'origin/' + branchName]);\n  await git.raw(['clean', '-fd']);\n}\n\n/* v8 ignore next 4 -- TODO: add test */\nexport async function resetToCommit(commit: LongCommitSha): Promise<void> {\n  logger.debug(`resetToCommit(${commit})`);\n  await git.raw(['reset', '--hard', commit]);\n}\n\nasync function deleteLocalBranch(branchName: string): Promise<void> {\n  await git.branch(['-D', branchName]);\n}\n\nasync function cleanLocalBranches(): Promise<void> {\n  const existingBranches = (await git.raw(['branch']))\n    .split(newlineRegex)\n    .map((branch) => branch.trim())\n    .filter((branch) => branch.length > 0 && !branch.startsWith('* '));\n  logger.debug({ existingBranches });\n  for (const branchName of existingBranches) {\n    await deleteLocalBranch(branchName);\n  }\n}\n\nexport function setGitAuthor(gitAuthor: string | undefined): void {\n  const gitAuthorParsed = parseGitAuthor(\n    gitAuthor ?? 'Renovate Bot <renovate@whitesourcesoftware.com>',\n  );\n  if (!gitAuthorParsed) {\n    const error = new Error(CONFIG_VALIDATION);\n    error.validationSource = 'None';\n    error.validationError = 'Invalid gitAuthor';\n    error.validationMessage = `\\`gitAuthor\\` is not parsed as valid RFC5322 format: \\`${gitAuthor!}\\``;\n    throw error;\n  }\n  config.gitAuthorName = gitAuthorParsed.name;\n  config.gitAuthorEmail = gitAuthorParsed.address;\n}\n\nexport async function writeGitAuthor(): Promise<void> {\n  const { gitAuthorName, gitAuthorEmail, writeGitDone } = config;\n  /* v8 ignore next 3 -- TODO: add test */\n  if (writeGitDone) {\n    return;\n  }\n  config.writeGitDone = true;\n  try {\n    if (gitAuthorName) {\n      logger.debug(`Setting git author name: ${gitAuthorName}`);\n      await git.addConfig('user.name', gitAuthorName);\n    }\n    if (gitAuthorEmail) {\n      logger.debug(`Setting git author email: ${gitAuthorEmail}`);\n      await git.addConfig('user.email', gitAuthorEmail);\n    }\n    /* v8 ignore next 11 -- TODO: add test */\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    logger.debug(\n      { err, gitAuthorName, gitAuthorEmail },\n      'Error setting git author config',\n    );\n    throw new Error(TEMPORARY_ERROR);\n  }\n}\n\nexport function setUserRepoConfig({\n  gitIgnoredAuthors,\n  gitAuthor,\n}: RenovateConfig): void {\n  config.ignoredAuthors = gitIgnoredAuthors ?? [];\n  setGitAuthor(gitAuthor);\n}\n\nexport async function getSubmodules(): Promise<string[]> {\n  try {\n    return (\n      (await git.raw([\n        'config',\n        '--file',\n        '.gitmodules',\n        '--get-regexp',\n        '\\\\.path',\n      ])) || ''\n    )\n      .trim()\n      .split(regEx(/[\\n\\s]/))\n      .filter((_e: string, i: number) => i % 2);\n    /* v8 ignore next 4 -- TODO: add test */\n  } catch (err) {\n    logger.warn({ err }, 'Error getting submodules');\n    return [];\n  }\n}\n\nexport async function cloneSubmodules(\n  shouldClone: boolean,\n  cloneSubmodulesFilter: string[] | undefined,\n): Promise<void> {\n  if (!shouldClone || submodulesInitizialized) {\n    return;\n  }\n  submodulesInitizialized = true;\n  await syncGit();\n  const submodules = await getSubmodules();\n  for (const submodule of submodules) {\n    if (!matchRegexOrGlobList(submodule, cloneSubmodulesFilter ?? ['*'])) {\n      logger.debug(\n        { cloneSubmodulesFilter },\n        `Skipping submodule ${submodule}`,\n      );\n      continue;\n    }\n    try {\n      logger.debug(`Cloning git submodule at ${submodule}`);\n      await gitRetry(() =>\n        git.submoduleUpdate(['--init', '--recursive', submodule]),\n      );\n    } catch (err) {\n      logger.warn({ err, submodule }, `Unable to initialise git submodule`);\n    }\n  }\n}\n\nexport function isCloned(): boolean {\n  return gitInitialized;\n}\n\nexport async function syncGit(): Promise<void> {\n  if (gitInitialized) {\n    /* v8 ignore next 3 -- TODO: add test */\n    if (process.env.RENOVATE_X_CLEAR_HOOKS) {\n      await git.raw(['config', 'core.hooksPath', '/dev/null']);\n    }\n    return;\n  }\n  /* v8 ignore next 3 -- failsafe TODO: add test */\n  if (GlobalConfig.get('platform') === 'local') {\n    throw new Error('Cannot sync git when platform=local');\n  }\n  gitInitialized = true;\n  const localDir = GlobalConfig.get('localDir')!;\n  logger.debug(`Initializing git repository into ${localDir}`);\n  const gitHead = upath.join(localDir, '.git/HEAD');\n  let clone = true;\n\n  if (await fs.pathExists(gitHead)) {\n    try {\n      await git.raw(['remote', 'set-url', 'origin', config.url]);\n      const fetchStart = Date.now();\n      await gitRetry(() => git.fetch(['--prune', 'origin']));\n      config.currentBranch =\n        config.currentBranch || (await getDefaultBranch(git));\n      await resetToBranch(config.currentBranch);\n      await cleanLocalBranches();\n      const durationMs = Math.round(Date.now() - fetchStart);\n      logger.info({ durationMs }, 'git fetch completed');\n      clone = false;\n      /* v8 ignore next 6 -- TODO: add test */\n    } catch (err) {\n      if (err.message === REPOSITORY_EMPTY) {\n        throw err;\n      }\n      logger.info({ err }, 'git fetch error');\n    }\n  }\n  if (clone) {\n    const cloneStart = Date.now();\n    try {\n      const opts: string[] = [];\n      if (config.defaultBranch) {\n        opts.push('-b', config.defaultBranch);\n      }\n      if (config.fullClone) {\n        logger.debug('Performing full clone');\n      } else {\n        logger.debug('Performing blobless clone');\n        opts.push('--filter=blob:none');\n      }\n      if (config.extraCloneOpts) {\n        Object.entries(config.extraCloneOpts).forEach((e) =>\n          // TODO: types (#22198)\n          opts.push(e[0], `${e[1]!}`),\n        );\n      }\n      const emptyDirAndClone = async (): Promise<void> => {\n        await fs.emptyDir(localDir);\n        await git.clone(config.url, '.', opts);\n      };\n      await gitRetry(() => emptyDirAndClone());\n      /* v8 ignore next 10 -- TODO: add test */\n    } catch (err) {\n      logger.debug({ err }, 'git clone error');\n      if (err.message?.includes('No space left on device')) {\n        throw new Error(SYSTEM_INSUFFICIENT_DISK_SPACE);\n      }\n      if (err.message === REPOSITORY_EMPTY) {\n        throw err;\n      }\n      throw new ExternalHostError(err, 'git');\n    }\n    const durationMs = Math.round(Date.now() - cloneStart);\n    logger.debug({ durationMs }, 'git clone completed');\n  }\n  try {\n    config.currentBranchSha = (\n      await git.raw(['rev-parse', 'HEAD'])\n    ).trim() as LongCommitSha;\n    /* v8 ignore next 6 -- TODO: add test */\n  } catch (err) {\n    if (err.message?.includes('fatal: not a git repository')) {\n      throw new Error(REPOSITORY_CHANGED);\n    }\n    throw err;\n  }\n  // This will only happen now if set in global config\n  await cloneSubmodules(!!config.cloneSubmodules, config.cloneSubmodulesFilter);\n  try {\n    const latestCommit = (await git.log({ n: 1 })).latest;\n    logger.debug({ latestCommit }, 'latest repository commit');\n    /* v8 ignore next 10 -- TODO: add test */\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    if (err.message.includes('does not have any commits yet')) {\n      throw new Error(REPOSITORY_EMPTY);\n    }\n    logger.warn({ err }, 'Cannot retrieve latest commit');\n  }\n  config.currentBranch =\n    config.currentBranch ??\n    config.defaultBranch ??\n    (await getDefaultBranch(git));\n  /* v8 ignore next -- TODO: add test */\n  delete getCache()?.semanticCommits;\n}\n\nexport async function getRepoStatus(path?: string): Promise<StatusResult> {\n  if (is.string(path)) {\n    const localDir = GlobalConfig.get('localDir');\n    const localPath = upath.resolve(localDir, path);\n    if (!localPath.startsWith(upath.resolve(localDir))) {\n      logger.warn(\n        { localPath, localDir },\n        'Preventing access to file outside the local directory',\n      );\n      throw new Error(INVALID_PATH);\n    }\n  }\n\n  await syncGit();\n  return git.status(path ? [path] : []);\n}\n\nexport function branchExists(branchName: string): boolean {\n  return !!config.branchCommits[branchName];\n}\n\n// Return the commit SHA for a branch\nexport function getBranchCommit(branchName: string): LongCommitSha | null {\n  return config.branchCommits[branchName] || null;\n}\n\nexport async function getCommitMessages(): Promise<string[]> {\n  logger.debug('getCommitMessages');\n  if (GlobalConfig.get('platform') !== 'local') {\n    await syncGit();\n  }\n  try {\n    const res = await git.log({\n      n: 20,\n      format: { message: '%s' },\n    });\n    return res.all.map((commit) => commit.message);\n    /* v8 ignore next 3 -- TODO: add test */\n  } catch {\n    return [];\n  }\n}\n\nexport async function checkoutBranch(\n  branchName: string,\n): Promise<LongCommitSha> {\n  logger.debug(`Setting current branch to ${branchName}`);\n  await syncGit();\n  try {\n    await gitRetry(() =>\n      git.checkout(\n        submodulesInitizialized\n          ? ['-f', '--recurse-submodules', branchName, '--']\n          : ['-f', branchName, '--'],\n      ),\n    );\n    config.currentBranch = branchName;\n    config.currentBranchSha = (\n      await git.raw(['rev-parse', 'HEAD'])\n    ).trim() as LongCommitSha;\n    const latestCommitDate = (await git.log({ n: 1 }))?.latest?.date;\n    if (latestCommitDate) {\n      logger.debug({ branchName, latestCommitDate }, 'latest commit');\n    }\n    await git.reset(ResetMode.HARD);\n    return config.currentBranchSha;\n    /* v8 ignore next 11 -- TODO: add test */\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    if (err.message?.includes('fatal: ambiguous argument')) {\n      logger.warn({ err }, 'Failed to checkout branch');\n      throw new Error(TEMPORARY_ERROR);\n    }\n    throw err;\n  }\n}\n\nexport async function getFileList(): Promise<string[]> {\n  await syncGit();\n  const branch = config.currentBranch;\n  let files: string;\n  try {\n    files = await git.raw(['ls-tree', '-r', branch]);\n    /* v8 ignore next 10 -- TODO: add test */\n  } catch (err) {\n    if (err.message?.includes('fatal: Not a valid object name')) {\n      logger.debug(\n        { err },\n        'Branch not found when checking branch list - aborting',\n      );\n      throw new Error(REPOSITORY_CHANGED);\n    }\n    throw err;\n  }\n  /* v8 ignore next 3 -- TODO: add test */\n  if (!files) {\n    return [];\n  }\n  // submodules are starting with `160000 commit`\n  return files\n    .split(newlineRegex)\n    .filter(is.string)\n    .filter((line) => line.startsWith('100'))\n    .map((line) => line.split(regEx(/\\t/)).pop()!);\n}\n\nexport function getBranchList(): string[] {\n  return Object.keys(config.branchCommits ?? {});\n}\n\nexport async function isBranchBehindBase(\n  branchName: string,\n  baseBranch: string,\n): Promise<boolean> {\n  const baseBranchSha = getBranchCommit(baseBranch);\n  const branchSha = getBranchCommit(branchName);\n  let isBehind = getCachedBehindBaseResult(\n    branchName,\n    branchSha,\n    baseBranch,\n    baseBranchSha,\n  );\n  if (isBehind !== null) {\n    logger.debug(`branch.isBehindBase(): using cached result \"${isBehind}\"`);\n    return isBehind;\n  }\n\n  logger.debug('branch.isBehindBase(): using git to calculate');\n\n  await syncGit();\n  try {\n    const behindCount = (\n      await git.raw(['rev-list', '--count', `${branchSha!}..${baseBranchSha!}`])\n    ).trim();\n    isBehind = behindCount !== '0';\n    logger.debug(\n      { baseBranch, branchName },\n      `branch.isBehindBase(): ${isBehind}`,\n    );\n    setCachedBehindBaseResult(branchName, isBehind);\n    return isBehind;\n    /* v8 ignore next 7 -- TODO: add test */\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    throw err;\n  }\n}\n\nexport async function isBranchModified(\n  branchName: string,\n  baseBranch: string,\n): Promise<boolean> {\n  if (!branchExists(branchName)) {\n    logger.debug('branch.isModified(): no cache');\n    return false;\n  }\n  // First check local config\n  if (config.branchIsModified[branchName] !== undefined) {\n    return config.branchIsModified[branchName];\n  }\n  // Second check repository cache\n  const isModified = getCachedModifiedResult(\n    branchName,\n    getBranchCommit(branchName), // branch sha\n  );\n  if (isModified !== null) {\n    logger.debug(`branch.isModified(): using cached result \"${isModified}\"`);\n    config.branchIsModified[branchName] = isModified;\n    return isModified;\n  }\n\n  logger.debug('branch.isModified(): using git to calculate');\n\n  await syncGit();\n  const committedAuthors = new Set<string>();\n  try {\n    const commits = await git.log([\n      `origin/${baseBranch}..origin/${branchName}`,\n    ]);\n\n    for (const commit of commits.all) {\n      committedAuthors.add(commit.author_email);\n    }\n    /* v8 ignore next 10 -- TODO: add test */\n  } catch (err) {\n    if (err.message?.includes('fatal: bad revision')) {\n      logger.debug(\n        { err },\n        'Remote branch not found when checking last commit author - aborting run',\n      );\n      throw new Error(REPOSITORY_CHANGED);\n    }\n    logger.warn({ err }, 'Error checking last author for isBranchModified');\n  }\n  const { gitAuthorEmail, ignoredAuthors } = config;\n\n  const includedAuthors = new Set(committedAuthors);\n\n  if (gitAuthorEmail) {\n    includedAuthors.delete(gitAuthorEmail);\n  }\n\n  for (const ignoredAuthor of ignoredAuthors) {\n    includedAuthors.delete(ignoredAuthor);\n  }\n\n  if (includedAuthors.size === 0) {\n    // authors all match - branch has not been modified\n    logger.trace(\n      {\n        branchName,\n        baseBranch,\n        committedAuthors: [...committedAuthors],\n        includedAuthors: [...includedAuthors],\n        gitAuthorEmail,\n        ignoredAuthors,\n      },\n      'branch.isModified() = false',\n    );\n    logger.debug('branch.isModified() = false');\n    config.branchIsModified[branchName] = false;\n    setCachedModifiedResult(branchName, false);\n    return false;\n  }\n  logger.trace(\n    {\n      branchName,\n      baseBranch,\n      committedAuthors: [...committedAuthors],\n      includedAuthors: [...includedAuthors],\n      gitAuthorEmail,\n      ignoredAuthors,\n    },\n    'branch.isModified() = true',\n  );\n  logger.debug(\n    { branchName, unrecognizedAuthors: [...includedAuthors] },\n    'branch.isModified() = true',\n  );\n  config.branchIsModified[branchName] = true;\n  setCachedModifiedResult(branchName, true);\n  return true;\n}\n\nexport async function isBranchConflicted(\n  baseBranch: string,\n  branch: string,\n): Promise<boolean> {\n  logger.debug(`isBranchConflicted(${baseBranch}, ${branch})`);\n\n  const baseBranchSha = getBranchCommit(baseBranch);\n  const branchSha = getBranchCommit(branch);\n  if (!baseBranchSha || !branchSha) {\n    logger.warn(\n      { baseBranch, branch },\n      'isBranchConflicted: branch does not exist',\n    );\n    return true;\n  }\n\n  const isConflicted = getCachedConflictResult(\n    branch,\n    branchSha,\n    baseBranch,\n    baseBranchSha,\n  );\n  if (is.boolean(isConflicted)) {\n    logger.debug(\n      `branch.isConflicted(): using cached result \"${isConflicted}\"`,\n    );\n    return isConflicted;\n  }\n\n  logger.debug('branch.isConflicted(): using git to calculate');\n\n  let result = false;\n  await syncGit();\n  await writeGitAuthor();\n\n  const origBranch = config.currentBranch;\n  try {\n    await git.reset(ResetMode.HARD);\n    //TODO: see #18600\n    if (origBranch !== baseBranch) {\n      await git.checkout(baseBranch);\n    }\n    await git.merge(['--no-commit', '--no-ff', `origin/${branch}`]);\n  } catch (err) {\n    result = true;\n    /* v8 ignore next 6 -- TODO: add test */\n    if (!err?.git?.conflicts?.length) {\n      logger.debug(\n        { baseBranch, branch, err },\n        'isBranchConflicted: unknown error',\n      );\n    }\n  } finally {\n    try {\n      await git.merge(['--abort']);\n      if (origBranch !== baseBranch) {\n        await git.checkout(origBranch);\n      }\n      /* v8 ignore next 6 -- TODO: add test */\n    } catch (err) {\n      logger.debug(\n        { baseBranch, branch, err },\n        'isBranchConflicted: cleanup error',\n      );\n    }\n  }\n\n  setCachedConflictResult(branch, result);\n  logger.debug(`branch.isConflicted(): ${result}`);\n  return result;\n}\n\nexport async function deleteBranch(branchName: string): Promise<void> {\n  await syncGit();\n  try {\n    const deleteCommand = ['push', '--delete', 'origin', branchName];\n\n    if (getNoVerify().includes('push')) {\n      deleteCommand.push('--no-verify');\n    }\n\n    await gitRetry(() => git.raw(deleteCommand));\n    logger.debug(`Deleted remote branch: ${branchName}`);\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    /* v8 ignore next 3 -- TODO: add test */\n    if (errChecked) {\n      throw errChecked;\n    }\n    logger.debug(`No remote branch to delete with name: ${branchName}`);\n  }\n  try {\n    /* v8 ignore next 2 -- TODO: add test (always throws) */\n    await deleteLocalBranch(branchName);\n    logger.debug(`Deleted local branch: ${branchName}`);\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    /* v8 ignore next 3 -- TODO: add test */\n    if (errChecked) {\n      throw errChecked;\n    }\n    logger.debug(`No local branch to delete with name: ${branchName}`);\n  }\n  delete config.branchCommits[branchName];\n}\n\nexport async function mergeToLocal(refSpecToMerge: string): Promise<void> {\n  let status: StatusResult | undefined;\n  try {\n    await syncGit();\n    await writeGitAuthor();\n    await git.reset(ResetMode.HARD);\n    await gitRetry(() =>\n      git.checkout([\n        '-B',\n        config.currentBranch,\n        'origin/' + config.currentBranch,\n      ]),\n    );\n    status = await git.status();\n    await fetchRevSpec(refSpecToMerge);\n    await gitRetry(() => git.merge(['FETCH_HEAD']));\n  } catch (err) {\n    logger.debug(\n      {\n        baseBranch: config.currentBranch,\n        baseSha: config.currentBranchSha,\n        refSpecToMerge,\n        status,\n        err,\n      },\n      'mergeLocally error',\n    );\n    throw err;\n  }\n}\n\nexport async function mergeBranch(branchName: string): Promise<void> {\n  let status: StatusResult | undefined;\n  try {\n    await syncGit();\n    await writeGitAuthor();\n    await git.reset(ResetMode.HARD);\n    await gitRetry(() =>\n      git.checkout(['-B', branchName, 'origin/' + branchName]),\n    );\n    await gitRetry(() =>\n      git.checkout([\n        '-B',\n        config.currentBranch,\n        'origin/' + config.currentBranch,\n      ]),\n    );\n    status = await git.status();\n    await gitRetry(() => git.merge(['--ff-only', branchName]));\n    await gitRetry(() => git.push('origin', config.currentBranch));\n    incLimitedValue('Commits');\n  } catch (err) {\n    logger.debug(\n      {\n        baseBranch: config.currentBranch,\n        baseSha: config.currentBranchSha,\n        branchName,\n        branchSha: getBranchCommit(branchName),\n        status,\n        err,\n      },\n      'mergeBranch error',\n    );\n    throw err;\n  }\n}\n\nexport async function getBranchLastCommitTime(\n  branchName: string,\n): Promise<Date> {\n  await syncGit();\n  try {\n    const time = await git.show(['-s', '--format=%ai', 'origin/' + branchName]);\n    return new Date(Date.parse(time));\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    /* v8 ignore next 3 -- TODO: add test */\n    if (errChecked) {\n      throw errChecked;\n    }\n    return new Date();\n  }\n}\n\nexport async function getBranchFiles(\n  branchName: string,\n): Promise<string[] | null> {\n  await syncGit();\n  try {\n    const diff = await gitRetry(() =>\n      git.diffSummary([`origin/${branchName}`, `origin/${branchName}^`]),\n    );\n    return diff.files.map((file) => file.file);\n    /* v8 ignore next 8 -- TODO: add test */\n  } catch (err) {\n    logger.warn({ err }, 'getBranchFiles error');\n    const errChecked = checkForPlatformFailure(err);\n    if (errChecked) {\n      throw errChecked;\n    }\n    return null;\n  }\n}\n\nexport async function getFile(\n  filePath: string,\n  branchName?: string,\n): Promise<string | null> {\n  await syncGit();\n  try {\n    const content = await git.show([\n      'origin/' + (branchName ?? config.currentBranch) + ':' + filePath,\n    ]);\n    return content;\n  } catch (err) {\n    const errChecked = checkForPlatformFailure(err);\n    /* v8 ignore next 3 -- TODO: add test */\n    if (errChecked) {\n      throw errChecked;\n    }\n    return null;\n  }\n}\n\nexport async function getFiles(\n  fileNames: string[],\n): Promise<Record<string, string | null>> {\n  const fileContentMap: Record<string, string | null> = {};\n\n  for (const fileName of fileNames) {\n    fileContentMap[fileName] = await getFile(fileName);\n  }\n\n  return fileContentMap;\n}\n\nexport async function hasDiff(\n  sourceRef: string,\n  targetRef: string,\n): Promise<boolean> {\n  await syncGit();\n  try {\n    return (\n      (await gitRetry(() => git.diff([sourceRef, targetRef, '--']))) !== ''\n    );\n  } catch {\n    return true;\n  }\n}\n\nasync function handleCommitAuth(localDir: string): Promise<void> {\n  if (!privateKeySet) {\n    await writePrivateKey();\n    privateKeySet = true;\n  }\n  await configSigningKey(localDir);\n  await writeGitAuthor();\n}\n\n/**\n *\n * Prepare local branch with commit\n *\n * 0. Hard reset\n * 1. Creates local branch with `origin/` prefix\n * 2. Perform `git add` (respecting mode) and `git remove` for each file\n * 3. Perform commit\n * 4. Check whether resulting commit is empty or not (due to .gitignore)\n * 5. If not empty, return commit info for further processing\n *\n */\nexport async function prepareCommit({\n  branchName,\n  files,\n  message,\n  force = false,\n}: CommitFilesConfig): Promise<CommitResult | null> {\n  const localDir = GlobalConfig.get('localDir')!;\n  await syncGit();\n  logger.debug(`Preparing files for committing to branch ${branchName}`);\n  await handleCommitAuth(localDir);\n  try {\n    await git.reset(ResetMode.HARD);\n    await git.raw(['clean', '-fd']);\n    const parentCommitSha = config.currentBranchSha;\n    await gitRetry(() =>\n      git.checkout(['-B', branchName, 'origin/' + config.currentBranch]),\n    );\n    const deletedFiles: string[] = [];\n    const addedModifiedFiles: string[] = [];\n    const ignoredFiles: string[] = [];\n    for (const file of files) {\n      const fileName = file.path;\n      if (file.type === 'deletion') {\n        try {\n          await git.rm([fileName]);\n          deletedFiles.push(fileName);\n          /* v8 ignore next 8 -- TODO: add test */\n        } catch (err) {\n          const errChecked = checkForPlatformFailure(err);\n          if (errChecked) {\n            throw errChecked;\n          }\n          logger.trace({ err, fileName }, 'Cannot delete file');\n          ignoredFiles.push(fileName);\n        }\n      } else {\n        if (await isDirectory(upath.join(localDir, fileName))) {\n          // This is usually a git submodule update\n          logger.trace({ fileName }, 'Adding directory commit');\n        } else if (file.contents === null) {\n          continue;\n        } else {\n          let contents: Buffer;\n          if (typeof file.contents === 'string') {\n            contents = Buffer.from(file.contents);\n            /* v8 ignore next 3 -- TODO: add test */\n          } else {\n            contents = file.contents;\n          }\n          // some file systems including Windows don't support the mode\n          // so the index should be manually updated after adding the file\n          if (file.isSymlink) {\n            await fs.symlink(file.contents, upath.join(localDir, fileName));\n          } else {\n            await fs.outputFile(upath.join(localDir, fileName), contents, {\n              mode: file.isExecutable ? 0o777 : 0o666,\n            });\n          }\n        }\n        try {\n          /* v8 ignore next 2 -- TODO: add test */\n          const addParams =\n            fileName === configFileNames[0] ? ['-f', fileName] : fileName;\n          await git.add(addParams);\n          if (file.isExecutable) {\n            await git.raw(['update-index', '--chmod=+x', fileName]);\n          }\n          addedModifiedFiles.push(fileName);\n          /* v8 ignore next 11 -- TODO: add test */\n        } catch (err) {\n          if (\n            !err.message.includes(\n              'The following paths are ignored by one of your .gitignore files',\n            )\n          ) {\n            throw err;\n          }\n          logger.debug(`Cannot commit ignored file: ${fileName}`);\n          ignoredFiles.push(file.path);\n        }\n      }\n    }\n\n    const commitOptions: Options = {};\n    if (getNoVerify().includes('commit')) {\n      commitOptions['--no-verify'] = null;\n    }\n\n    const commitRes = await git.commit(message, [], commitOptions);\n    if (\n      commitRes.summary &&\n      commitRes.summary.changes === 0 &&\n      commitRes.summary.insertions === 0 &&\n      commitRes.summary.deletions === 0\n    ) {\n      logger.warn({ commitRes }, 'Detected empty commit - aborting git push');\n      return null;\n    }\n    logger.debug(\n      { deletedFiles, ignoredFiles, result: commitRes },\n      `git commit`,\n    );\n    if (!force && !(await hasDiff('HEAD', `origin/${branchName}`))) {\n      logger.debug(\n        { branchName, deletedFiles, addedModifiedFiles, ignoredFiles },\n        'No file changes detected. Skipping commit',\n      );\n      return null;\n    }\n\n    const commitSha = (\n      await git.revparse([branchName])\n    ).trim() as LongCommitSha;\n    const result: CommitResult = {\n      parentCommitSha,\n      commitSha,\n      files: files.filter((fileChange) => {\n        if (fileChange.type === 'deletion') {\n          return deletedFiles.includes(fileChange.path);\n        }\n        return addedModifiedFiles.includes(fileChange.path);\n      }),\n    };\n\n    return result;\n    /* v8 ignore next 3 -- TODO: add test */\n  } catch (err) {\n    return handleCommitError(err, branchName, files);\n  }\n}\n\nexport async function pushCommit({\n  sourceRef,\n  targetRef,\n  files,\n}: PushFilesConfig): Promise<boolean> {\n  await syncGit();\n  logger.debug(`Pushing refSpec ${sourceRef}:${targetRef ?? sourceRef}`);\n  let result = false;\n  try {\n    const pushOptions: TaskOptions = {\n      '--force-with-lease': null,\n      '-u': null,\n    };\n    if (getNoVerify().includes('push')) {\n      pushOptions['--no-verify'] = null;\n    }\n\n    const pushRes = await gitRetry(() =>\n      git.push('origin', `${sourceRef}:${targetRef ?? sourceRef}`, pushOptions),\n    );\n    delete pushRes.repo;\n    logger.debug({ result: pushRes }, 'git push');\n    incLimitedValue('Commits');\n    result = true;\n    /* v8 ignore next 3 -- TODO: add test */\n  } catch (err) {\n    handleCommitError(err, sourceRef, files);\n  }\n  return result;\n}\n\nexport async function fetchBranch(\n  branchName: string,\n): Promise<LongCommitSha | null> {\n  await syncGit();\n  logger.debug(`Fetching branch ${branchName}`);\n  try {\n    const ref = `refs/heads/${branchName}:refs/remotes/origin/${branchName}`;\n    await gitRetry(() => git.pull(['origin', ref, '--force']));\n    const commit = (await git.revparse([branchName])).trim() as LongCommitSha;\n    config.branchCommits[branchName] = commit;\n    config.branchIsModified[branchName] = false;\n    return commit;\n    /* v8 ignore next 3 -- TODO: add test */\n  } catch (err) {\n    return handleCommitError(err, branchName);\n  }\n}\n\nexport async function commitFiles(\n  commitConfig: CommitFilesConfig,\n): Promise<LongCommitSha | null> {\n  try {\n    const commitResult = await prepareCommit(commitConfig);\n    if (commitResult) {\n      const pushResult = await pushCommit({\n        sourceRef: commitConfig.branchName,\n        files: commitConfig.files,\n      });\n      if (pushResult) {\n        const { branchName } = commitConfig;\n        const { commitSha } = commitResult;\n        config.branchCommits[branchName] = commitSha;\n        config.branchIsModified[branchName] = false;\n        return commitSha;\n      }\n    }\n    return null;\n    /* v8 ignore next 6 -- TODO: add test */\n  } catch (err) {\n    if (err.message.includes('[rejected] (stale info)')) {\n      throw new Error(REPOSITORY_CHANGED);\n    }\n    throw err;\n  }\n}\n\nexport function getUrl({\n  protocol,\n  auth,\n  hostname,\n  host,\n  repository,\n}: {\n  protocol?: GitProtocol;\n  auth?: string;\n  hostname?: string;\n  host?: string;\n  repository: string;\n}): string {\n  if (protocol === 'ssh') {\n    // TODO: types (#22198)\n    return `git@${hostname!}:${repository}.git`;\n  }\n  return URL.format({\n    protocol: protocol ?? 'https',\n    auth,\n    hostname,\n    host,\n    pathname: repository + '.git',\n  });\n}\n\nlet remoteRefsExist = false;\n\n/**\n *\n * Non-branch refs allow us to store git objects without triggering CI pipelines.\n * It's useful for API-based branch rebasing.\n *\n * @see https://stackoverflow.com/questions/63866947/pushing-git-non-branch-references-to-a-remote/63868286\n *\n */\nexport async function pushCommitToRenovateRef(\n  commitSha: string,\n  refName: string,\n): Promise<void> {\n  const fullRefName = `refs/renovate/branches/${refName}`;\n  await git.raw(['update-ref', fullRefName, commitSha]);\n  await git.push(['--force', 'origin', fullRefName]);\n  remoteRefsExist = true;\n}\n\n/**\n *\n * Removes all remote \"refs/renovate/branches/*\" refs in two steps:\n *\n * Step 1: list refs\n *\n *   $ git ls-remote origin \"refs/renovate/branches/*\"\n *\n *   > cca38e9ea6d10946bdb2d0ca5a52c205783897aa        refs/renovate/branches/foo\n *   > 29ac154936c880068994e17eb7f12da7fdca70e5        refs/renovate/branches/bar\n *   > 3fafaddc339894b6d4f97595940fd91af71d0355        refs/renovate/branches/baz\n *   > ...\n *\n * Step 2:\n *\n *   $ git push --delete origin refs/renovate/branches/foo refs/renovate/branches/bar refs/renovate/branches/baz\n *\n * If Step 2 fails because the repo doesn't allow bulk changes, we'll remove them one by one instead:\n *\n *   $ git push --delete origin refs/renovate/branches/foo\n *   $ git push --delete origin refs/renovate/branches/bar\n *   $ git push --delete origin refs/renovate/branches/baz\n */\nexport async function clearRenovateRefs(): Promise<void> {\n  if (!gitInitialized || !remoteRefsExist) {\n    return;\n  }\n\n  logger.debug(`Cleaning up Renovate refs: refs/renovate/branches/*`);\n  const renovateRefs: string[] = [];\n\n  try {\n    const rawOutput = await git.listRemote([\n      config.url,\n      'refs/renovate/branches/*',\n    ]);\n    const refs = rawOutput\n      .split(newlineRegex)\n      .map((line) => line.replace(regEx(/[0-9a-f]+\\s+/i), '').trim())\n      .filter((line) => line.startsWith('refs/renovate/branches/'));\n    renovateRefs.push(...refs);\n    /* v8 ignore next 3 -- TODO: add test */\n  } catch (err) {\n    logger.warn({ err }, `Renovate refs cleanup error`);\n  }\n\n  if (renovateRefs.length) {\n    try {\n      const pushOpts = ['--delete', 'origin', ...renovateRefs];\n      await git.push(pushOpts);\n    } catch (err) {\n      if (bulkChangesDisallowed(err)) {\n        for (const ref of renovateRefs) {\n          try {\n            const pushOpts = ['--delete', 'origin', ref];\n            await git.push(pushOpts);\n            /* v8 ignore next 4 -- TODO: add test */\n          } catch (err) {\n            logger.debug({ err }, 'Error deleting \"refs/renovate/branches/*\"');\n            break;\n          }\n        }\n        /* v8 ignore next 3 -- TODO: add test */\n      } else {\n        logger.warn({ err }, 'Error deleting \"refs/renovate/branches/*\"');\n      }\n    }\n  }\n\n  remoteRefsExist = false;\n}\n\nconst treeItemRegex = regEx(\n  /^(?<mode>\\d{6})\\s+(?<type>blob|tree|commit)\\s+(?<sha>[0-9a-f]{40})\\s+(?<path>.*)$/,\n);\n\nconst treeShaRegex = regEx(/tree\\s+(?<treeSha>[0-9a-f]{40})\\s*/);\n\n/**\n *\n * Obtain top-level items of commit tree.\n * We don't need subtree items, so here are 2 steps only.\n *\n * Step 1: commit SHA -> tree SHA\n *\n *   $ git cat-file -p <commit-sha>\n *\n *   > tree <tree-sha>\n *   > parent 59b8b0e79319b7dc38f7a29d618628f3b44c2fd7\n *   > ...\n *\n * Step 2: tree SHA -> tree items (top-level)\n *\n *   $ git cat-file -p <tree-sha>\n *\n *   > 040000 tree 389400684d1f004960addc752be13097fe85d776    src\n *   > ...\n *   > 100644 blob 7d2edde437ad4e7bceb70dbfe70e93350d99c98b    package.json\n *\n */\nexport async function listCommitTree(\n  commitSha: LongCommitSha,\n): Promise<TreeItem[]> {\n  const commitOutput = await git.catFile(['-p', commitSha]);\n  const { treeSha } =\n    /* v8 ignore next -- will never happen ? */\n    treeShaRegex.exec(commitOutput)?.groups ?? {};\n  const contents = await git.catFile(['-p', treeSha]);\n  const lines = contents.split(newlineRegex);\n  const result: TreeItem[] = [];\n  for (const line of lines) {\n    const matchGroups = treeItemRegex.exec(line)?.groups;\n    if (matchGroups) {\n      const { path, mode, type, sha } = matchGroups;\n      result.push({ path, mode, type, sha: sha as LongCommitSha });\n    }\n  }\n  return result;\n}\n"]}