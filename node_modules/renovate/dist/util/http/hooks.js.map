{"version":3,"file":"hooks.js","sourceRoot":"","sources":["../../../lib/util/http/hooks.ts"],"names":[],"mappings":";;;AAKA,oCAOC;AAED,oBAMC;AAfD,SAAgB,YAAY,CAAC,QAAkB;IAC7C,MAAM,EAAE,UAAU,EAAE,GAAG,QAAQ,CAAC;IAChC,MAAM,eAAe,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;IAE5E,OAAO,CACL,CAAC,UAAU,IAAI,GAAG,IAAI,UAAU,IAAI,eAAe,CAAC,IAAI,UAAU,KAAK,GAAG,CAC3E,CAAC;AACJ,CAAC;AAED,SAAgB,IAAI,CAAC,QAAkB;IACrC,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE,CAAC;QAC3B,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAED,OAAO,QAAQ,CAAC;AAClB,CAAC;AAEY,QAAA,KAAK,GAAU;IAC1B,aAAa,EAAE,CAAC,IAAI,CAAC;CACtB,CAAC","sourcesContent":["// Renovate issue: https://github.com/renovatebot/renovate/issues/12127\n// Got issue: https://github.com/sindresorhus/got/issues/1489\n// From here: https://github.com/sindresorhus/got/issues/1489#issuecomment-805485731\nimport type { Hooks, Response } from 'got';\n\nexport function isResponseOk(response: Response): boolean {\n  const { statusCode } = response;\n  const limitStatusCode = response.request.options.followRedirect ? 299 : 399;\n\n  return (\n    (statusCode >= 200 && statusCode <= limitStatusCode) || statusCode === 304\n  );\n}\n\nexport function hook(response: Response): Response {\n  if (isResponseOk(response)) {\n    response.request.destroy();\n  }\n\n  return response;\n}\n\nexport const hooks: Hooks = {\n  afterResponse: [hook],\n};\n"]}