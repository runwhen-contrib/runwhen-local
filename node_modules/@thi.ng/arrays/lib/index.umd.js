!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@thi.ng/compare"),require("@thi.ng/equiv"),require("@thi.ng/checks"),require("@thi.ng/errors"),require("@thi.ng/api"),require("@thi.ng/random")):"function"==typeof define&&define.amd?define(["exports","@thi.ng/compare","@thi.ng/equiv","@thi.ng/checks","@thi.ng/errors","@thi.ng/api","@thi.ng/random"],r):r(((e="undefined"!=typeof globalThis?globalThis:e||self).thi=e.thi||{},e.thi.ng=e.thi.ng||{},e.thi.ng.arrays={}),e.thi.ng.compare,e.thi.ng.equiv,e.thi.ng.checks,e.thi.ng.errors,e.thi.ng.api,e.thi.ng.random)}(this,(function(e,r,t,n,i,s,o){"use strict";const u=(e,r=e.length>>>1)=>[e.slice(0,r),e.slice(r)],l=e=>((null==e||!e[Symbol.iterator])&&i.illegalArgs(`value is not iterable: ${e}`),e),h=(e,r,n=t.equiv)=>{for(let t=e.length;--t>=0;)if(n(r,e[t]))return t;return-1},a=(e,r,t,n=1/0)=>{let i=e.length<n?e.length+1:n;for(;--i>t;)e[i]=e[i-1];return e[t]=r,e};const c=(e,r)=>e===r,f=(e,r,t=1/0,n=c)=>{if(e===r)return 0;if(e.length>r.length){const t=e;e=r,r=t}let i=e.length,s=r.length;for(;i>0&&n(e[~-i],r[~-s]);)i--,s--;let o=0;for(;o<i&&n(e[o],r[o]);)o++;if(i-=o,s-=o,0===i||s<3)return s;let u,l,h,a,f,g,d,p,y,b,m,q,S,v=0;const k=(e,r,t,i,s)=>e<r||t<r?e>t?t+1:e+1:n(s,i)?r:r+1,w=[];for(u=0;u<i;u++)w.push(u+1,e[o+u]);const x=w.length-1,A=s-3;for(;v<A;){for(b=r[o+(h=v)],m=r[o+(a=v+1)],q=r[o+(f=v+2)],S=r[o+(g=v+3)],d=v+=4,l=1/0,u=0;u<x;u+=2)p=w[u],y=w[u+1],h=k(p,h,a,b,y),a=k(h,a,f,m,y),f=k(a,f,g,q,y),d=k(f,g,d,S,y),d<l&&(l=d),w[u]=d,g=f,f=a,a=h,h=p;if(l>t)return 1/0}for(;v<s;){for(b=r[o+(h=v)],d=++v,l=1/0,u=0;u<x;u+=2)p=w[u],w[u]=d=k(p,h,d,b,w[u+1]),d<l&&(l=d),h=p;if(l>t)return 1/0}return d},g=(e,r,t)=>{const n=e[r];e[r]=e[t],e[t]=n},d=(...e)=>{const[r,t,n]=e,i=e.length;switch(i){case 0:return g;case 1:return(e,t,n)=>{g(e,t,n),g(r,t,n)};case 2:return(e,n,i)=>{g(e,n,i),g(r,n,i),g(t,n,i)};case 3:return(e,i,s)=>{g(e,i,s),g(r,i,s),g(t,i,s),g(n,i,s)};default:return(r,t,n)=>{g(r,t,n);for(let r=i;--r>=0;)g(e[r],t,n)}}};function p(e,t=r.compare,n=g,i=0,s=e.length-1){if(i<s){const r=e[i+(s-i>>1)];let o=i-1,u=s+1;for(;;){do{o++}while(t(e[o],r)<0);do{u--}while(t(e[u],r)>0);if(o>=u)break;n(e,o,u)}p(e,t,n,i,u),p(e,t,n,u+1,s)}return e}const y=(e,r=0,t=e.length,n=o.SYSTEM)=>{s.assert(r>=0&&t>=r&&t<=e.length,`illegal range ${r}..${t}`);let i=t-r;const u=i;if(u>1)for(;--i>=0;){const t=r+n.float(u)|0,i=r+n.float(u)|0,s=e[t];e[t]=e[i],e[i]=s}return e};e.arrayIterator=function*(e,r=0,t){if(!e)return;r=r,void 0===t&&(t=e.length);const n=r<=t?1:-1;for(;r!==t;r+=n)yield e[r]},e.binarySearch=(e,t,n=(e=>e),i=r.compare,s=0,o=e.length-1)=>{const u=n(t);for(;s<=o;){const r=s+o>>>1,t=i(n(e[r]),u);if(t<0)s=r+1;else{if(!(t>0))return r;o=r-1}}return-s-1},e.binarySearch16=(e,r)=>{let t=e[8]<=r?8:0;return t|=e[t+4]<=r?4:0,t|=e[t+2]<=r?2:0,t|=e[t+1]<=r?1:0,e[t]===r?t:e[0]<r?-t-2:-1},e.binarySearch2=(e,r)=>{let t=e[1]<=r?1:0;return e[t]===r?t:e[0]<r?-t-2:-1},e.binarySearch32=(e,r)=>{let t=e[16]<=r?16:0;return t|=e[t+4]<=r?8:0,t|=e[t+4]<=r?4:0,t|=e[t+2]<=r?2:0,t|=e[t+1]<=r?1:0,e[t]===r?t:e[0]<r?-t-2:-1},e.binarySearch4=(e,r)=>{let t=e[2]<=r?2:0;return t|=e[t+1]<=r?1:0,e[t]===r?t:e[0]<r?-t-2:-1},e.binarySearch8=(e,r)=>{let t=e[4]<=r?4:0;return t|=e[t+2]<=r?2:0,t|=e[t+1]<=r?1:0,e[t]===r?t:e[0]<r?-t-2:-1},e.binarySearchNumeric=(e,t,n=r.compareNumAsc,i=0,s=e.length-1)=>{for(;i<=s;){const r=i+s>>>1,o=n(e[r],t);if(o<0)i=r+1;else{if(!(o>0))return r;s=r-1}}return-i-1},e.bisect=u,e.bisectWith=(e,r)=>{const t=e.findIndex(r);return t>=0?u(e,t):[e,[]]},e.bsEQ=e=>e<0?-1:e,e.bsGE=(e,r)=>(e=e<0?-e-1:e)<r?e:-1,e.bsGT=(e,r)=>(e=e<0?-e-1:e+1)<r?e:-1,e.bsLE=e=>e<0?-e-2:e,e.bsLT=e=>e<0?-e-2:e-1,e.endsWith=(e,r,n=t.equiv)=>{let i=e.length,s=r.length;if(i<s)return!1;for(;--i,--s>=0&&n(e[i],r[s]););return s<0},e.ensureArray=e=>n.isArray(e)?e:[...l(e)],e.ensureArrayLike=e=>n.isArrayLike(e)?e:[...l(e)],e.ensureIterable=l,e.fillRange=(e,r=0,t=0,n=e.length,i=(n>t?1:-1))=>{if(i>0)for(;t<n;t+=i)e[r++]=t;else for(;t>n;t+=i)e[r++]=t;return e},e.find=(e,r,n=t.equiv)=>{const i=h(e,r,n);return-1!==i?e[i]:void 0},e.findIndex=h,e.first=e=>e[0],e.fuzzyMatch=(e,r,n=t.equiv)=>{const i=e.length,s=r.length;if(s>i)return!1;if(s===i)return n(r,e);e:for(let t=0,o=0;t<s;t++){const s=r[t];for(;o<i;)if(n(e[o++],s))continue e;return!1}return!0},e.insert=(e,r,t,n=1/0)=>t<0||t>=n||n<1?e:a(e,r,t,n),e.insertUnsafe=a,e.into=(e,r,t=1/0)=>{for(let n of r){if(--t<0)break;e.push(n)}return e},e.isSorted=(e,t=r.compare,n=0,i=e.length)=>{let s=e[n];for(;++n<i;){const r=e[n];if(t(s,r)>0)return!1;s=r}return!0},e.levenshtein=f,e.multiSwap=d,e.normalizedLevenshtein=(e,r,t=1/0,n=c)=>{const i=Math.max(e.length,r.length);return i>0?f(e,r,t,n)/i:0},e.peek=e=>e[e.length-1],e.quickSort=p,e.shuffle=(e,r=e.length,t=o.SYSTEM)=>y(e,0,r,t),e.shuffleRange=y,e.sortByCachedKey=(e,t,i=r.compare)=>{const o=n.isFunction(t)?e.map(t):t;return s.assert(o.length===e.length,"keys.length != src.length"),p(o,i,d(e)),e},e.startsWith=(e,r,n=t.equiv)=>{let i=e.length,s=r.length;if(i<s)return!1;for(;-s>=0&&n(e[s],r[s]););return s<0},e.swap=g,e.swizzle=e=>{const[r,t,n,i,s,o,u,l]=e;switch(e.length){case 0:return()=>[];case 1:return e=>[e[r]];case 2:return e=>[e[r],e[t]];case 3:return e=>[e[r],e[t],e[n]];case 4:return e=>[e[r],e[t],e[n],e[i]];case 5:return e=>[e[r],e[t],e[n],e[i],e[s]];case 6:return e=>[e[r],e[t],e[n],e[i],e[s],e[o]];case 7:return e=>[e[r],e[t],e[n],e[i],e[s],e[o],e[u]];case 8:return e=>[e[r],e[t],e[n],e[i],e[s],e[o],e[u],e[l]];default:return r=>{const t=[];for(let n=e.length;--n>=0;)t[n]=r[e[n]];return t}}},Object.defineProperty(e,"__esModule",{value:!0})}));